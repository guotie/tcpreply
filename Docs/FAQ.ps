%!PS-Adobe-2.0
%%Creator: dvips(k) 5.95a Copyright 2005 Radical Eye Software
%%Title: FAQ.dvi
%%Pages: 22
%%PageOrder: Ascend
%%BoundingBox: 0 0 595 842
%%DocumentFonts: Times-Roman Times-Bold CMSY10 Courier Times-Italic
%%DocumentPaperSizes: a4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -o FAQ.ps FAQ.dvi
%DVIPSParameters: dpi=600
%DVIPSSource:  TeX output 2005.07.03:1303
%%BeginProcSet: tex.pro 0 0
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/CharBuilder{save 3 1 roll S A/base get 2 index get S
/BitMaps get S get/Cd X pop/ctr 0 N Cdx 0 Cx Cy Ch sub Cx Cw add Cy
setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx sub Cy .1 sub]{Ci}imagemask
restore}B/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc 0 0
% File 8r.enc  TeX Base 1 Encoding  Revision 2.0  2002-10-30
%
% @@psencodingfile@{
%   author    = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry,
%                W. Schmidt, P. Lehman",
%   version   = "2.0",
%   date      = "30 October 2002",
%   filename  = "8r.enc",
%   email     = "tex-fonts@@tug.org",
%   docstring = "This is the encoding vector for Type1 and TrueType
%                fonts to be used with TeX.  This file is part of the
%                PSNFSS bundle, version 9"
% @}
% 
% The idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard encoding, ISO Latin 1, Windows ANSI including the euro symbol,
% MacRoman, and some extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% These are /dotlessj /ff /ffi /ffl.
% 
% (4) hyphen appears twice for compatibility with both ASCII and Windows.
%
% (5) /Euro was assigned to 128, as in Windows ANSI
%
% (6) Missing characters from MacRoman encoding incorporated as follows:
%
%     PostScript      MacRoman        TeXBase1
%     --------------  --------------  --------------
%     /notequal       173             0x16
%     /infinity       176             0x17
%     /lessequal      178             0x18
%     /greaterequal   179             0x19
%     /partialdiff    182             0x1A
%     /summation      183             0x1B
%     /product        184             0x1C
%     /pi             185             0x1D
%     /integral       186             0x81
%     /Omega          189             0x8D
%     /radical        195             0x8E
%     /approxequal    197             0x8F
%     /Delta          198             0x9D
%     /lozenge        215             0x9E
%
/TeXBase1Encoding [
% 0x00
 /.notdef /dotaccent /fi /fl
 /fraction /hungarumlaut /Lslash /lslash
 /ogonek /ring /.notdef /breve
 /minus /.notdef /Zcaron /zcaron
% 0x10
 /caron /dotlessi /dotlessj /ff
 /ffi /ffl /notequal /infinity
 /lessequal /greaterequal /partialdiff /summation
 /product /pi /grave /quotesingle
% 0x20
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus
 /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three
 /four /five /six /seven
 /eight /nine /colon /semicolon
 /less /equal /greater /question
% 0x40
 /at /A /B /C
 /D /E /F /G
 /H /I /J /K
 /L /M /N /O
% 0x50
 /P /Q /R /S
 /T /U /V /W
 /X /Y /Z /bracketleft
 /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c
 /d /e /f /g
 /h /i /j /k
 /l /m /n /o
% 0x70
 /p /q /r /s
 /t /u /v /w
 /x /y /z /braceleft
 /bar /braceright /asciitilde /.notdef
% 0x80
 /Euro /integral /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /Omega /radical /approxequal
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /Delta /lozenge /Ydieresis
% 0xA0
 /.notdef /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot /hyphen /registered /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde
 /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def


%%EndProcSet
%%BeginProcSet: texps.pro 0 0
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]FontType 0
ne{/Metrics exch def dict begin Encoding{exch dup type/integertype ne{
pop pop 1 sub dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get
div def}ifelse}forall Metrics/Metrics currentdict end def}{{1 index type
/nametype eq{exit}if exch pop}loop}ifelse[2 index currentdict end
definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{dup
sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1 roll
mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def dup[
exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}if}
forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}def
end

%%EndProcSet
%%BeginFont: CMSY10
%!PS-AdobeFont-1.1: CMSY10 1.0
%%CreationDate: 1991 Aug 15 07:20:57
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMSY10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.035 def
/isFixedPitch false def
end readonly def
/FontName /CMSY10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 15 /bullet put
readonly def
/FontBBox{-29 -960 1116 775}readonly def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA052F09F9C8ADE9D907C058B87E9B6964
7D53359E51216774A4EAA1E2B58EC3176BD1184A633B951372B4198D4E8C5EF4
A213ACB58AA0A658908035BF2ED8531779838A960DFE2B27EA49C37156989C85
E21B3ABF72E39A89232CD9F4237FC80C9E64E8425AA3BEF7DED60B122A52922A
221A37D9A807DD01161779DDE7D31FF2B87F97C73D63EECDDA4C49501773468A
27D1663E0B62F461F6E40A5D6676D1D12B51E641C1D4E8E2771864FC104F8CBF
5B78EC1D88228725F1C453A678F58A7E1B7BD7CA700717D288EB8DA1F57C4F09
0ABF1D42C5DDD0C384C7E22F8F8047BE1D4C1CC8E33368FB1AC82B4E96146730
DE3302B2E6B819CB6AE455B1AF3187FFE8071AA57EF8A6616B9CB7941D44EC7A
71A7BB3DF755178D7D2E4BB69859EFA4BBC30BD6BB1531133FD4D9438FF99F09
4ECC068A324D75B5F696B8688EEB2F17E5ED34CCD6D047A4E3806D000C199D7C
515DB70A8D4F6146FE068DC1E5DE8BC5703711DA090312BA3FC00A08C453C609
C627A8BECD6E1FA14A3B02476E90AAD8B4700C400380BC9AFFBF7847EB28661B
9DC3AA0F44C533F2E07DCC4DE19D367BF223E33DC321D0247A0E6EF6ABC8FA52
15AE044094EF678A8726CD7C011F02BFF8AB6EAEEE391AD837120823BED0B5D8
F8B15245377871A64F78378BB4330149D6941F7A86FBFFC49B93C94155F5FA7D
F22E7214511C0A92693F4CDBF38411651540572F2DD70D924AE0F18E1CD581F3
C871399127FF5D07A868885B5FF7CDEB50B8323B2533DEF8DC973B1AE84FA0A2

0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
TeXDict begin 39139632 55387786 1000 600 600 (FAQ.dvi)
@start /Fa 134[40 1[40 1[40 40 40 40 1[40 40 40 40 1[40
40 40 40 40 40 40 40 40 40 40 16[40 3[40 17[40 10[40
40 46[{TeXBase1Encoding ReEncodeFont}26 66.4176 /Courier
rf /Fb 107[29 29 25[33 1[48 33 33 18 26 22 33 33 33 33
52 18 33 1[18 33 33 22 29 33 29 33 29 9[63 1[48 41 37
1[48 37 48 48 1[41 5[37 41 48 44 1[48 6[18 5[33 2[33
1[18 17 22 17 2[22 22 5[27 30[37 37 2[{TeXBase1Encoding ReEncodeFont}51
66.4176 /Times-Roman rf /Fc 198[25 25 25 25 25 25 25
25 25 25 48[{TeXBase1Encoding ReEncodeFont}10 49.8132
/Times-Roman rf /Fd 105[42 1[46 46 25[37 37 55 37 42
23 32 32 1[42 42 42 60 23 37 23 23 42 42 23 37 42 37
42 42 1[42 6[51 69 2[46 42 51 1[51 60 55 1[46 1[37 28
2[51 51 60 55 51 51 2[56 1[56 1[28 42 42 42 42 42 42
42 42 42 42 23 21 28 21 5[65 35[42 2[{TeXBase1Encoding ReEncodeFont}64
83.022 /Times-Italic rf /Fe 129[50 3[50 50 1[50 50 50
50 50 50 1[50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 6[50 50 50 50 50 50 50 50 50 50 50 50 50 50
2[50 50 50 50 50 50 50 50 50 5[50 50 50 4[50 50 50 50
50 50 50 50 50 2[50 50 50 39[{TeXBase1Encoding ReEncodeFont}64
83.022 /Courier rf /Ff 198[29 29 29 29 29 29 29 29 29
29 48[{TeXBase1Encoding ReEncodeFont}10 58.1154 /Times-Roman
rf /Fg 240[42 15[{}1 83.022 /CMSY10 rf /Fh 135[86 1[86
96 57 67 76 1[96 86 96 4[48 96 86 57 76 96 76 1[86 7[124
3[124 1[96 124 2[134 12[115 124 65[{TeXBase1Encoding ReEncodeFont}24
172.188 /Times-Bold rf /Fi 105[42 28[42 1[60 42 46 28
32 37 46 46 42 46 69 23 46 1[23 46 42 28 37 46 37 46
42 9[83 1[60 55 46 60 1[51 65 1[78 55 2[32 65 65 51 55
60 60 55 60 1[42 4[28 42 42 42 42 42 42 42 42 42 42 23
21 1[21 4[28 69 38[{TeXBase1Encoding ReEncodeFont}59
83.022 /Times-Bold rf /Fj 133[44 50 50 72 50 55 33 39
44 55 55 50 55 83 28 55 1[28 55 50 33 44 55 44 55 50
1[50 5[72 72 100 72 72 66 55 72 78 61 78 72 94 66 2[39
78 1[61 66 72 72 66 72 1[50 1[57 1[33 33 50 50 50 50
50 50 50 50 50 50 28 25 33 25 1[50 33 33 33 5[33 29[55
55 2[{TeXBase1Encoding ReEncodeFont}73 99.6264 /Times-Bold
rf /Fk 134[60 1[86 60 66 40 47 53 66 66 60 66 100 33
66 1[33 66 60 40 53 66 53 66 60 9[120 86 86 80 66 86
1[73 93 1[113 80 2[47 1[93 73 80 86 86 80 86 6[40 60
60 60 60 60 60 60 60 60 60 3[30 4[40 100 38[{
TeXBase1Encoding ReEncodeFont}55 119.552 /Times-Bold
rf /Fl 105[42 1[37 37 24[37 42 42 60 42 42 23 32 28 42
42 42 42 65 23 42 23 23 42 42 28 37 42 37 42 37 1[42
5[60 60 78 60 60 51 46 55 60 46 60 60 74 51 60 32 28
60 60 46 51 60 55 55 60 76 37 47 47 47 23 23 42 42 42
42 42 42 42 42 42 42 23 21 28 21 1[42 28 28 28 3[42 34
28 29[46 46 2[{TeXBase1Encoding ReEncodeFont}85 83.022
/Times-Roman rf /Fm 134[50 50 2[50 28 39 33 1[50 50 50
78 28 2[28 50 50 33 44 50 44 50 44 1[50 10[61 55 6[61
6[61 3[72 2[56 1[56 1[28 3[50 1[50 1[50 1[50 28 25 1[25
44[{TeXBase1Encoding ReEncodeFont}36 99.6264 /Times-Roman
rf /Fn 134[72 72 5[48 1[72 3[40 6[64 1[64 1[64 12[88
2[104 10[80 4[104 14[72 3[36 46[{TeXBase1Encoding ReEncodeFont}14
143.462 /Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4
 end
%%EndSetup
%%Page: 1 1
TeXDict begin 1 0 bop 1399 68 a Fn(Tcpreplay)34 b(2.x)h(F)-11
b(A)j(Q)1137 359 y Fm(Aaron)24 b(T)l(urner)h(<aturner_A)-11
b(T_pobox.com>)1315 475 y(http://tcpreplay)-6 b(.sourcefor)n(ge.net/)
1708 718 y(Last)24 b(Edited:)1700 818 y(Sept)h(6,)f(2004)1929
5895 y Fl(1)p eop end
%%Page: 2 2
TeXDict begin 2 1 bop -364 -281 a Fk(Contents)-364 55
y Fj(I)100 b(Bef)n(or)n(e)25 b(Y)-11 b(ou)25 b(Start)3731
b(5)-364 288 y Fi(1)83 b(General)19 b(Inf)n(o)4009 b(5)-239
437 y Fl(1.1)86 b(What)20 b(is)h(this)g(F)-6 b(A)h(Q)21
b(for?)35 b(.)42 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)123 b(5)-239 587 y(1.2)86 b(What)20
b(tools)h(come)e(with)h(tcpreplay?)38 b(.)j(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)123 b(5)-239 736 y(1.3)86 b(Ho)n(w)20
b(can)g(I)g(get)g(tcpreplay')-5 b(s)19 b(source?)73 b(.)42
b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(5)-239
886 y(1.4)86 b(What)20 b(requirements)e(does)i(tcpreplay)f(ha)n(v)o(e?)
37 b(.)k(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(5)-239
1035 y(1.5)86 b(Ho)n(w)20 b(do)g(I)g(compile)f(tcpreplay?)45
b(.)c(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(5)-239 1185 y(1.6)86 b(Are)20 b(there)g(binaries)f(a)n(v)n(ailable?)
64 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(6)-239 1334 y(1.7)86 b(Is)20 b(there)g(a)h(Microsoft)e(W)m(indo)n(ws)
h(port?)g(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(6)-239 1483 y(1.8)86 b(Ho)n(w)20 b(is)h(tcpreplay)e(licensed?)54
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
123 b(6)-239 1633 y(1.9)86 b(What)20 b(is)h(tcpreplay?)77
b(.)41 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)123 b(6)-239 1782 y(1.10)44 b(What)20
b(isn')o(t)g(tcpreplay?)48 b(.)42 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(6)-239 1932
y(1.11)44 b(What)20 b(are)g(some)g(uses)h(for)f(tcpreplay?)51
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(6)-239 2081 y(1.12)44 b(What)20 b(are)g(some)g(uses)h(for)f(\003o)n
(wreplay?)70 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(6)-239 2231 y(1.13)44 b(What)20 b(happened)e(to)j(v)o(ersion)d(1.5?)
45 b(.)c(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(7)-239 2380 y(1.14)44 b(What)20 b(is)h(the)g(history)e(of)h
(tcpreplay?)49 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)123 b(7)-364 2613 y Fi(2)83 b(Bugs,)21 b(F)n(eatur)o(e)d(Requests,)j
(and)g(P)o(atches)3164 b(7)-239 2762 y Fl(2.1)86 b(Where)20
b(can)g(I)g(get)g(help,)g(report)f(b)n(ugs)h(or)g(contact)f(the)h(de)n
(v)o(elopers?)75 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)123 b(7)-239 2911 y(2.2)86 b(What)20
b(information)e(should)h(I)i(pro)o(vide)d(when)h(I)i(report)e(a)h(b)n
(ug?)h(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)123 b(7)-239 3061 y(2.3)86 b(I)20 b(ha)n(v)o(e)g(a)g
(feature)g(request,)f(what)h(should)f(I)i(do?)41 b(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)123 b(7)-239 3210 y(2.4)86 b(I')l(v)o(e)19
b(written)h(a)g(patch)g(for)f(tcpreplay)-5 b(,)18 b(ho)n(w)i(can)g(I)h
(submit)e(it?)83 b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(7)-239 3360 y(2.5)86
b(P)o(atch)20 b(requirements)61 b(.)41 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(8)-364
3696 y Fj(II)99 b(Basics)4135 b(8)-364 3928 y Fi(3)83
b(Basic)21 b(Tcpr)o(eplay)e(Usage)3655 b(8)-239 4078
y Fl(3.1)86 b(Replaying)19 b(the)h(traf)n(\002c)g(.)41
b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)123 b(8)-239 4227 y(3.2)86 b(Replaying)19
b(at)h(dif)n(ferent)f(speeds)44 b(.)d(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(8)-239 4377 y(3.3)86
b(Replaying)19 b(the)h(same)g(\002le)h(o)o(v)o(er)e(and)h(o)o(v)o(er)e
(again)56 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123 b(9)-239
4526 y(3.4)86 b(Using)20 b(Con\002guration)e(Files)26
b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)123 b(9)-364 4862 y Fj(III)99 b(Adv)o(anced)26 b(Usage)3657
b(9)1929 5895 y Fl(2)p eop end
%%Page: 3 3
TeXDict begin 3 2 bop -364 -281 a Fi(4)83 b(Output:)24
b(Interfaces,)c(P)o(ack)o(ets)g(&)h(Files)3206 b(9)-239
-133 y Fl(4.1)86 b(Replaying)19 b(on)h(multiple)f(interf)o(aces)51
b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)123
b(9)-239 15 y(4.2)86 b(Selecti)n(v)o(ely)19 b(sending)g(or)h(dropping)e
(pack)o(ets)61 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(10)-239 162 y(4.3)k(Replaying)19 b(only)g(a)i(fe)n(w)f(pack)o(ets)33
b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(10)-239 310 y(4.4)k(Skipping)18 b(the)j(\002rst)f(bytes)g(in)h(a)f
(pcap)g(\002le)47 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(11)-239 458 y(4.5)k(Replaying)19 b(pack)o(ets)h(which)f(are)h(bigger)
f(then)h(the)g(MTU)80 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(11)-239
605 y(4.6)k(Writing)20 b(pack)o(ets)g(to)g(a)h(\002le)29
b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)82 b(11)-239 753 y(4.7)k(Extracting)18 b(Application)h(Data)i
(\(Layer)e(7\))55 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(11)-239 901 y(4.8)k(Replaying)19 b(Li)n(v)o(e)g(T)m(raf)n(\002c)73
b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)82 b(11)-239 1049 y(4.9)k(Replaying)19 b(P)o(ack)o(et)h
(Capture)f(F)o(ormats)h(Other)g(Than)f(Libpcap)32 b(.)42
b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)82 b(12)-239 1196 y(4.10)44 b(Replaying)19 b(Client)i(T)m(raf)n
(\002c)e(to)i(a)f(Serv)o(er)75 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)82 b(12)-239 1344 y(4.11)44 b(Decoding)18
b(P)o(ack)o(ets)44 b(.)d(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(12)-364 1575
y Fi(5)h(P)o(ack)o(et)20 b(Editing)3898 b(12)-239 1722
y Fl(5.1)86 b(Re)n(writing)19 b(MA)m(C)i(addresses)74
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
82 b(12)-239 1870 y(5.2)k(Randomizing)18 b(IP)i(addresses)69
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
82 b(13)-239 2018 y(5.3)k(Replaying)19 b(\(de\)truncated)e(pack)o(ets)
63 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(13)-239 2165 y(5.4)k(Re)n(writing)19 b(Layer)h(2)g(with)g(-2)j(.)41
b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(13)-239 2313 y(5.5)k(Re)n(writing)19 b(DL)-8 b(T_LINUX_SLL)19
b(\(Linux)g(Cook)o(ed)g(Sock)o(et\))g(captures)43 b(.)f(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(13)-239
2461 y(5.6)k(Re)n(writing)19 b(IP)i(Addresses)f(\(pseudo-N)m(A)-9
b(T\))37 b(.)k(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(14)-239 2609 y(5.7)k(Adv)n(anced)18 b(pseudo-N)m(A)-9
b(T)47 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)82 b(14)-239 2756 y(5.8)k(IP)20 b(Endpoints)f(.)41
b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(14)-239 2904 y(5.9)k(Unifying)18
b(Dual-Outputs)52 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(14)-364 3135 y Fi(6)h(Tcppr)o(ep)20
b(Usage)3884 b(15)-239 3282 y Fl(6.1)86 b(What)20 b(is)h(tcpprep?)75
b(.)41 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)82 b(15)-239 3430 y(6.2)k(Ho)n(w)20
b(does)g(tcpprep)e(w)o(ork?)58 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(15)-239 3578
y(6.3)k(Does)20 b(tcpprep)f(modify)f(my)i(libpcap)f(\002le?)68
b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(15)-239
3726 y(6.4)k(Why)19 b(use)i(tcpprep?)38 b(.)j(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(15)-239 3873 y(6.5)k(Can)20 b(a)h(cache)f(\002le)g(be)h(used)e(for)h
(multiple)g(\(dif)n(ferent\))d(libpcap)j(\002les?)97
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(15)-239 4021 y(6.6)k(Why)19 b(w)o(ould)h(I)g(w)o(ant)h(to)f(use)g
(tcpreplay)f(with)h(tw)o(o)h(netw)o(ork)e(cards?)68 b(.)41
b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(15)-239 4169 y(6.7)k(Ho)n(w)20 b(big)g(are)g(the)g(cache)g(\002les?)
77 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(15)-239 4316 y(6.8)k(What)20 b(are)g(these)h('modes')e(tcpprep)f
(has?)100 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(15)-239 4464 y(6.9)k(Splitting)20 b(traf)n(\002c)f(based)h(upon)f(IP)
i(address)59 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(16)-239 4612 y(6.10)44 b(Auto)20 b(Mode)70 b(.)41 b(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)82 b(16)-48 4759 y(6.10.1)55 b(Ho)n(w)20 b(does)g(Auto/Bridge)f
(mode)g(w)o(ork?)106 b(.)41 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(16)-48 4907 y(6.10.2)55 b(Ho)n(w)20 b(does)g(Auto/Router)f(mode)g(w)o
(ork?)106 b(.)41 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(16)-48 5055
y(6.10.3)55 b(Determining)19 b(Clients)i(and)e(Serv)o(ers)35
b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(16)-48
5203 y(6.10.4)55 b(Client/Serv)o(er)20 b(ratio)69 b(.)42
b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(17)-239 5350 y(6.11)44 b(Selecti)n(v)o(ely)19 b(sending/dropping)d
(pack)o(ets)25 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(17)-239 5498 y(6.12)44 b(Using)20 b(tcpprep)f(cache)g(\002les)i(with)
g(tcpreplay)49 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(17)-239 5646 y(6.13)44 b(Commenting)18 b(tcpprep)h(cache)h(\002les)65
b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(17)1929 5895 y(3)p eop end
%%Page: 4 4
TeXDict begin 4 3 bop -364 -281 a Fi(7)83 b(Flo)o(wr)o(eplay)18
b(Usage)3788 b(17)-239 -131 y Fl(7.1)86 b(Ho)n(w)20 b(\003o)n(wreplay)f
(w)o(orks)69 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)82 b(17)-239 18 y(7.2)k(Running)18
b(\003o)n(wreplay)40 b(.)h(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(18)-364 251 y
Fi(8)h(T)-8 b(uning)21 b(OS')m(s)g(f)n(or)e(high)i(perf)n(ormance)3202
b(18)-239 400 y Fl(8.1)86 b(Linux)19 b(2.4.x)65 b(.)41
b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(18)-239 549 y(8.2)k(*BSD)62
b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(18)-364
782 y Fi(9)h(Understanding)20 b(Common)g(Err)o(or)g(and)h(W)-5
b(ar)o(ning)19 b(Messages)2475 b(18)-239 931 y Fl(9.1)86
b(Can')o(t)19 b(open)h(eth0:)k(libnet_select_de)n(vice\(\):)e(Can')o(t)
e(\002nd)g(interf)o(ace)f(eth0)31 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)h(.)f(.)82 b(18)-239 1081 y(9.2)k(Can')o(t)19
b(open)h(lo:)25 b(libnet_select_de)n(vice\(\):)d(Can')o(t)e(\002nd)g
(interf)o(ace)f(lo)63 b(.)41 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)82 b(18)-239 1230 y(9.3)k(Can')o(t)19
b(open)h(eth0:)k(UID)d(!=)f(0)67 b(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(18)-239 1380
y(9.4)k(100000)18 b(write)i(attempts)g(f)o(ailed)g(from)f(full)h(b)n
(uf)n(fers)f(and)h(were)g(repeated)48 b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(19)-239 1529 y(9.5)k(In)m(v)n(alid)18
b(mac)i(address:)25 b(00:00:00:00:00:00)60 b(.)41 b(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)82 b(19)-239 1679 y(9.6)k(Unable)19 b(to)i(process)e
(test.cache:)25 b(cache)20 b(\002le)h(v)o(ersion)e(missmatch)63
b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)82 b(19)-239 1828 y(9.7)k(Skipping)18 b(SLL)j(loopback)d(pack)o(et.)
23 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(19)-239 1977 y(9.8)k(P)o(ack)o(et)20 b(length)f(\(8892\))f(is)j
(greater)e(then)h(MTU;)g(skipping)f(pack)o(et.)35 b(.)41
b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(19)-239 2127 y(9.9)k(Why)19 b(is)j(tcpreplay)c(not)i(sending)f(all)i
(the)f(pack)o(ets?)68 b(.)41 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(19)-364 2359 y Fi(10)41 b(Requir)o(ed)20 b(Libraries)h(and)g(T)-8
b(ools)3375 b(20)-239 2509 y Fl(10.1)44 b(Libpcap)54
b(.)41 b(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(20)-239
2658 y(10.2)44 b(Libnet)j(.)42 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(20)-239 2808 y(10.3)44 b(Libpcapna)n(v)59 b(.)41 b(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)82 b(20)-239 2957 y(10.4)44 b(Tcpdump)69 b(.)41
b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82 b(20)-364 3293 y Fj(IV)100
b(Other)25 b(Resour)n(ces)3609 b(20)-364 3526 y Fi(11)41
b(Other)20 b(pcap)g(tools)g(a)n(v)o(ailable)3492 b(20)-239
3675 y Fl(11.1)44 b(T)-7 b(ools)20 b(to)g(capture)f(netw)o(ork)g(traf)n
(\002c)h(or)g(decode)f(pcap)h(\002les)36 b(.)41 b(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)82
b(20)-239 3825 y(11.2)44 b(T)-7 b(ools)20 b(to)g(edit)h(pcap)e(\002les)
77 b(.)41 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)82 b(21)-239 3974 y(11.3)44 b(Other)19 b(useful)h(tools)44
b(.)d(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)82 b(21)-364 4207 y Fi(A)65 b(BSD)21
b(License)3971 b(22)1929 5895 y Fl(4)p eop end
%%Page: 5 5
TeXDict begin 5 4 bop -364 -281 a Fk(P)o(art)30 b(I)-364
-23 y Fh(Bef)l(or)m(e)44 b(Y)-19 b(ou)44 b(Start)-364
288 y Fk(1)120 b(General)30 b(Inf)m(o)-364 540 y Fj(1.1)99
b(What)25 b(is)g(this)g(F)-9 b(A)l(Q)23 b(f)n(or?)-364
745 y Fl(Tcpreplay)j(is)i(a)g(suite)g(of)f(po)n(werful)f(tools,)j(b)n
(ut)f(with)f(that)h(po)n(wer)f(comes)g(comple)o(xity)-5
b(.)44 b(While)28 b(I)g(ha)n(v)o(e)f(done)f(my)h(best)h(to)g(write)g
(good)e(man)h(pages)g(for)-364 845 y(tcpreplay)i(and)g(it')-5
b(s)31 b(associated)f(utilities,)i(I)e(understand)e(that)i(man)o(y)f
(people)g(may)g(w)o(ant)h(more)f(information)f(then)h(I)h(can)g(pro)o
(vide)e(in)i(the)g(man)f(pages.)-364 945 y(Additionally)-5
b(,)23 b(this)i(F)-6 b(A)h(Q)25 b(attempts)g(to)f(co)o(v)o(er)f
(material)h(which)g(I)g(feel)h(will)g(be)f(of)g(use)h(to)f(people)f
(using)h(tcpreplay)-5 b(,)23 b(as)i(well)g(as)g(common)e(questions)g
(that)-364 1044 y(occur)c(on)h(the)g(Tcpreplay-Users)e
(<tcpreplay-users@lists.sourcefor)o(ge.net>)d(mailing)k(list.)-364
1332 y Fj(1.2)99 b(What)25 b(tools)f(come)i(with)f(tcpr)n(eplay?)-239
1521 y Fg(\017)41 b Fl(tcpreplay)18 b(-)j(replay)e(ethernet)g(pack)o
(ets)h(stored)g(in)g(a)h(pcap)e(\002le)i(as)g(the)o(y)f(were)g
(captured)-239 1687 y Fg(\017)41 b Fl(tcpprep)19 b(-)h(a)h(pcap)e
(pre-processor)f(for)h(tcpreplay)-239 1853 y Fg(\017)41
b Fl(\003o)n(wreplay)199 1823 y Ff(1)251 1853 y Fl(-)20
b(connects)f(to)i(a)f(serv)o(er\(s\))f(and)h(replays)f(the)i(client)f
(side)g(of)g(the)g(connection)f(stored)g(in)i(a)f(pcap)g(\002le)-239
2019 y Fg(\017)41 b Fl(pcapmer)o(ge)17 b(-)k(mer)o(ges)e(tw)o(o)h(or)g
(more)f(pcap)h(\002les)h(into)f(one)-239 2185 y Fg(\017)41
b Fl(capinfo)19 b(-)h(displays)g(basic)g(information)e(about)h(a)i
(pcap)e(\002le)-364 2472 y Fj(1.3)99 b(Ho)o(w)25 b(can)g(I)g(get)g
(tcpr)n(eplay')l(s)h(sour)n(ce?)-364 2678 y Fl(The)17
b(source)f(code)h(is)h(a)n(v)n(ailable)e(in)i(tarball)e(format)h(on)f
(the)h(tcpreplay)f(homepage:)21 b Fe(http://tcpreplay.sourceforge.net/)
12 b Fl(I)17 b(also)h(encourage)-364 2777 y(users)j(f)o(amiliar)e(with)
i(CVS)g(to)f(try)g(checking)f(out)h(the)g(latest)h(code)e(as)i(it)g
(often)f(has)g(additional)f(features)g(and)h(b)n(ug\002x)o(es)f(not)h
(found)e(in)j(the)f(tarballs.)-364 2927 y(cvs)h(-d:pserv)o(er:anon)o
(ymou)o(s@cvs.sf.net:/cv)o(sroo)o(t/tcpr)o(eplay)14 b(login)-364
3026 y(P)o(ass:)26 b Fd(<Enter>)-364 3126 y Fl(cvs)21
b(-z3)e(-d:pserv)o(er:anon)o(ymous@cvs.sf.n)o(et:/cvsro)o(ot/tcpr)o
(epla)o(y)c(co)20 b(tcpreplay)-364 3414 y Fj(1.4)99 b(What)25
b(r)n(equir)n(ements)j(does)d(tcpr)n(eplay)h(ha)n(v)o(e?)-260
3602 y Fl(1.)41 b(Y)-9 b(ou')o(ll)19 b(need)h(the)g(libnet)g(and)g
(libpcap)f(libraries.)-260 3768 y(2.)41 b(T)-7 b(o)20
b(support)f(the)h(jump)g(to)g(of)n(fset)g(feature,)f(you')o(ll)g(need)g
(the)i(libpcapna)n(v)1982 3738 y Ff(2)2033 3768 y Fl(library)-5
b(.)-260 3934 y(3.)41 b(T)-7 b(o)20 b(support)f(the)h(pack)o(et)g
(decoding)e(feature)h(you')o(ll)g(need)h(tcpdump)1844
3904 y Ff(3)1895 3934 y Fl(installed.)-260 4101 y(4.)41
b(Y)-9 b(ou')o(ll)26 b(also)i(need)e(a)i(compatible)d(operating)g
(system.)46 b(Basically)-5 b(,)29 b(an)o(y)d(UNIX-lik)o(e)h(or)f
(UNIX-based)g(operating)f(system)j(should)e(w)o(ork.)45
b(Linux,)-156 4200 y(*BSD,)24 b(Solaris,)i(OS)f(X)f(and)g(others)g
(should)f(all)i(w)o(ork.)37 b(If)24 b(you)f(\002nd)h(an)o(y)g
(compatibility)e(issues)k(with)e(an)o(y)g(UNIX-lik)o(e/based)e(OS,)j
(please)f(let)h(me)-156 4300 y(kno)n(w)-5 b(.)-364 4587
y Fj(1.5)99 b(Ho)o(w)25 b(do)g(I)f(compile)h(tcpr)n(eplay?)-364
4793 y Fl(T)-7 b(w)o(o)21 b(easy)f(steps:)-260 5025 y(1.)41
b(As)21 b(a)f(normal)f(user:)25 b Fd(./con\002gur)m(e)19
b(&&)g(mak)o(e)-260 5191 y Fl(2.)41 b(As)21 b(root:)j
Fd(mak)o(e)c(test)i(-i)e(&&)g(mak)o(e)g(install)p -364
5245 1851 4 v -273 5301 a Fc(1)-244 5324 y Fb(Flo)n(wreplay)f(is)e
(still)h(\223alpha\224)i(quality)f(and)f(is)e(not)i(usable)g(for)f
(most)g(situations.)23 b(An)o(yone)18 b(interested)i(in)d(helping)i(me)
d(de)n(v)o(elop)k(\003o)n(wreplay)f(is)e(encouraged)i(to)f(contact)h
(me.)-273 5382 y Fc(2)-244 5405 y Fb(http://netdude.sourcefor)o(ge)q
(.net/)-273 5462 y Fc(3)-244 5486 y Fb(http://www)l(.tcpdump.or)o(g/)
1929 5895 y Fl(5)p eop end
%%Page: 6 6
TeXDict begin 6 5 bop -364 -281 a Fl(There)32 b(are)h(some)f(optional)f
(ar)o(guments)g(which)h(can)g(be)h(passed)g(to)f(the)h(con\002gure)e
(script)h(which)h(may)f(help)g(in)h(cases)g(where)f(your)f(libnet,)36
b(libpcap,)-364 -181 y(libpcapna)n(v)22 b(or)i(tcpdump)e(installation)h
(is)i(not)e(standard)g(or)g(if)h(it)h(can')o(t)e(determine)f(the)i
(correct)f(netw)o(ork)f(interf)o(ace)h(card)g(to)h(use)g(for)f
(testing.)36 b(If)24 b(you)f(\002nd)-364 -82 y(that)e(con\002gure)d
(isn')o(t)i(completing)e(correctly)-5 b(,)18 b(run:)25
b Fd(./con\002gur)m(e)18 b(\226help)h Fl(for)h(more)f(information.)-364
68 y(A)i(fe)n(w)f(comments)f(about)g('mak)o(e)h(test':)-239
300 y Fg(\017)41 b Fl(mak)o(e)20 b(test)h(is)g(just)f(a)h(series)g(of)f
(sanity)g(checks)g(which)f(try)h(to)h(\002nd)e(serious)h(b)n(ugs)g
(\(crashes\))g(in)g(tcpprep)f(and)g(tcpreplay)-5 b(.)-239
466 y Fg(\017)41 b Fl(mak)o(e)21 b(test)h(requires)f(at)h(least)g(one)f
(properly)f(con\002gured)f(netw)o(ork)h(interf)o(ace.)29
b(If)21 b(the)h(con\002gure)d(script)j(can')o(t)f(guess)g(what)h(a)g(v)
n(alid)f(interf)o(ace)g(is)h(you)-156 566 y(can)e(specify)f(it)i(with)g
(the)f(\226with-testnic)f(and)h(\226with-testnic2)f(ar)o(guments.)-239
732 y Fg(\017)41 b Fl(If)20 b(mak)o(e)g(test)h(f)o(ails,)f(often)g(you)
f(can)h(\002nd)g(details)g(in)h(test/test.log.)-239 898
y Fg(\017)41 b Fl(OpenBSD')-5 b(s)19 b(mak)o(e)h(has)f(a)h(b)n(ug)f
(where)g(it)h(ignores)e(the)i(MAKEFLA)m(GS)f(v)n(ariable)f(in)i(the)f
(Mak)o(e\002le,)h(hence)e(you')o(ll)h(probably)e(w)o(ant)j(to)f(run:)24
b Fd(mak)o(e)c(-is)-156 998 y(test)i Fl(instead.)-364
1285 y Fj(1.6)99 b(Ar)n(e)26 b(ther)n(e)g(binaries)f(a)n(v)o(ailable?)
-364 1491 y Fl(Occasionally)-5 b(.)26 b(And)20 b(e)n(v)o(en)g(when)h
(we)g(do,)f(generally)g(only)g(for)g(one)h(or)f(tw)o(o)i(operating)d
(systems.)27 b(Generally)20 b(speaking,)g(we)h(assume)g(people)f(who)g
(w)o(ant)h(to)-364 1590 y(use)g(a)f(tool)g(lik)o(e)h(this)f(can)g
(\002gure)g(out)g(ho)n(w)f(to)i(compile)e(it.)-364 1878
y Fj(1.7)99 b(Is)25 b(ther)n(e)h(a)f(Micr)n(osoft)g(W)n(indo)o(ws)g
(port?)-364 2083 y Fl(Not)d(really)-5 b(.)28 b(W)-7 b(e)23
b(had)e(one)g(user)g(port)g(the)h(code)f(o)o(v)o(er)f(for)h(a)h
(slightly)f(old)h(v)o(ersion)e(of)h(tcpreplay)f(to)i(W)m(indo)n(ws.)29
b(No)n(w)21 b(we')l(re)g(looking)f(for)h(someone)f(to)i(help)-364
2183 y(mer)o(ge)g(and)h(maintain)g(the)h(code)e(in)i(to)g(the)f(main)g
(de)n(v)o(elopment)e(tree.)35 b(If)24 b(you')l(re)d(interested)i(in)h
(helping)e(with)i(this)g(please)f(contact)g(Aaron)g(T)l(urner)f(or)h
(the)-364 2283 y(tcpreplay-users)18 b(list.)-364 2570
y Fj(1.8)99 b(Ho)o(w)25 b(is)f(tcpr)n(eplay)i(licensed?)-364
2775 y Fl(Tcpreplay)19 b(is)i(licensed)e(under)g(a)i(BSD-style)g
(license.)k(F)o(or)19 b(details,)i(see)g(Appendix)d(A.)-364
3063 y Fj(1.9)99 b(What)25 b(is)g(tcpr)n(eplay?)-364
3268 y Fl(In)20 b(the)g(simplest)g(terms,)g(tcpreplay)f(is)i(a)f(tool)g
(to)g(send)g(netw)o(ork)e(traf)n(\002c)i(stored)g(in)g(pcap)f(format)g
(back)g(onto)h(the)g(netw)o(ork;)e(basically)i(the)g(e)o(xact)g
(opposite)f(of)-364 3368 y(tcpdump.)29 b(Tcpreplay)21
b(also)h(has)h(the)f(ability)g(to)g(edit)g(v)n(arious)g(pack)o(et)f
(headers)h(as)g(the)h(pack)o(ets)f(are)g(sent.)31 b(Tcpreplay)20
b(is)k(also)e(a)h(suite)f(of)g(tools:)29 b(tcpreplay)-5
b(,)-364 3468 y(tcpprep,)19 b(pcapmer)o(ge,)e(capinfo)i(and)g(\003o)n
(wreplay)-5 b(.)-364 3755 y Fj(1.10)99 b(What)25 b(isn't)g(tcpr)n
(eplay?)-364 3961 y Fl(Tcpreplay)18 b(is)j Fd(not)g Fl(a)g(tool)f(to)g
(replay)f(captured)f(traf)n(\002c)i(to)g(a)h(serv)o(er)e(or)g(client.)
25 b(Speci\002cally)-5 b(,)19 b(tcpreplay)g(does)h(not)f(ha)n(v)o(e)h
(the)g(ability)f(to)i(re)n(write)e(IP)i(addresses)-364
4060 y(to)g(a)f(user)n(-speci\002ed)f(v)n(alue)h(or)g(synchronize)e
(TCP)j(sequence)e(and)g(ackno)n(wledgment)e(numbers.)24
b(In)c(other)f(w)o(ords,)h(tcpreplay)e(can')o(t)i(\223connect\224)e(to)
j(a)f(serv)o(er)-364 4160 y(or)g(be)g(used)g(to)h(emulate)e(a)i(serv)o
(er)e(and)h(ha)n(v)o(e)f(clients)i(connect)e(to)h(it.)26
b(If)20 b(you')l(re)e(looking)h(for)g(that,)h(check)g(out)f(\003o)n
(wreplay)-5 b(.)-364 4447 y Fj(1.11)99 b(What)25 b(ar)n(e)h(some)e
(uses)h(f)n(or)g(tcpr)n(eplay?)-364 4653 y Fl(Originally)-5
b(,)29 b(tcpreplay)e(w)o(as)i(written)f(to)g(test)i(netw)o(ork)d
(intrusion)g(detection)g(systems)i(\(NIDS\),)f(ho)n(we)n(v)o(er)e
(tcpreplay)h(has)i(been)e(used)h(to)h(test)g(\002re)n(w)o(alls,)-364
4752 y(routers,)19 b(and)h(other)f(netw)o(ork)g(de)n(vices.)-364
5040 y Fj(1.12)99 b(What)25 b(ar)n(e)h(some)e(uses)h(f)n(or)g(\003o)o
(wr)n(eplay?)-364 5245 y Fl(A)30 b(lot)f(of)g(people)f(w)o(anted)g(a)h
(tool)g(lik)o(e)g(tcpreplay)-5 b(,)29 b(b)n(ut)g(w)o(anted)g(to)g(be)g
(able)g(to)g(replay)f(traf)n(\002c)h Fd(to)g Fl(a)g(serv)o(er)-5
b(.)51 b(Since)29 b(tcpreplay)f(w)o(as)h(unable)f(to)h(do)g(this,)-364
5345 y(I)i(de)n(v)o(eloped)e(\003o)n(wreplay)g(which)i(replays)f(the)h
(data)g(portion)e(of)i(the)g(\003o)n(w)-5 b(,)33 b(b)n(ut)e(recreates)g
(the)g(connection)e(to)i(the)g(speci\002ed)f(serv)o(er\(s\).)56
b(This)31 b(mak)o(es)-364 5445 y(\003o)n(wreplay)24 b(an)h(ideal)g
(tool)f(to)h(test)h(host)f(intrusion)f(detection)g(systems)h(\(HIDS\))g
(as)g(well)h(as)f(captured)f(e)o(xploits)g(and)g(security)h(patches)f
(when)h(the)g(actual)-364 5544 y(e)o(xploit)19 b(code)h(is)h(not)f(a)n
(v)n(ailable.)k(Please)d(note)f(that)g(\003o)n(wreplay)f(is)i(still)g
(alpha)f(quality)f(code)h(and)g(is)h(currently)d(missing)i(some)g
(important)f(features.)1929 5895 y(6)p eop end
%%Page: 7 7
TeXDict begin 7 6 bop -364 -281 a Fj(1.13)99 b(What)25
b(happened)i(to)e(v)o(ersion)g(1.5?)-364 -75 y Fl(After)f(looking)f(at)
i(all)g(the)f(changes)g(that)g(ha)n(v)o(e)g(happened)e(o)o(v)o(er)h
(the)h(last)i(year)d(or)i(so,)g(I)g(decided)e(that)h(it)h(w)o(as)h
(\002nally)e(time)g(to)h(graduate)e(tcpreplay)f(to)j(2.0)-364
24 y(status.)h(Hence)20 b(the)g(1.5)f(branch)g(w)o(as)i(renamed)e(2.0.)
-364 312 y Fj(1.14)99 b(What)25 b(is)f(the)i(history)f(of)g(tcpr)n
(eplay?)-364 517 y Fl(Tcpreplay)19 b(has)i(had)f(quite)g(a)h(fe)n(w)g
(authors)e(o)o(v)o(er)g(the)i(past)g(\002)n(v)o(e)f(or)h(so)g(years.)26
b(One)20 b(of)g(the)h(adv)n(antages)e(of)h(the)h(BSD)g(and)g(GPL)g
(licenses)g(is)g(that)g(if)g(someone)-364 617 y(becomes)e(unable)h(or)f
(unwilling)h(to)g(continue)f(de)n(v)o(elopment,)e(an)o(yone)h(else)j
(can)f(tak)o(e)g(o)o(v)o(er)-5 b(.)-364 766 y(Originally)g(,)25
b(Matt)g(Undy)f(of)h(Anzen)f(Computing)g(wrote)h(tcpreplay)-5
b(.)37 b(Matt)26 b(released)e(v)o(ersion)g(1.0.1)g(sometime)g(in)i
(1999.)38 b(Sometime)24 b(after)h(that,)h(Anzen)-364
866 y(Computing)19 b(w)o(as)i(\(at)f(least)h(partially\))e(purchased)f
(by)i(NFR)h(and)f(de)n(v)o(elopment)d(ceased.)-364 1015
y(Then)27 b(in)h(2001,)h(tw)o(o)f(people)f(independently)e(started)i(w)
o(ork)h(on)f(tcpreplay:)39 b(Matt)29 b(Bing)f(of)f(NFR)i(and)f(Aaron)f
(T)l(urner)-5 b(.)47 b(After)28 b(de)n(v)o(eloping)d(a)j(series)h(of)
-364 1115 y(patches)20 b(\(the)g(-adt)g(branch\),)e(Aaron)h(attempted)g
(to)h(send)g(the)h(patches)e(in)i(to)f(be)g(included)f(in)h(the)g(main)
g(de)n(v)o(elopment)e(tree.)-364 1264 y(After)30 b(some)f(discussion)g
(between)g(Aaron)g(and)g(Matt)h(Bing,)h(the)o(y)e(decided)g(to)g
(continue)g(de)n(v)o(elopment)d(together)-5 b(.)53 b(Since)29
b(then,)i(o)o(v)o(er)e(a)h(dozen)e(stable)-364 1364 y(releases)21
b(ha)n(v)o(e)e(been)h(made)f(and)h(more)f(then)h(twenty)g(ne)n(w)g
(features)f(ha)n(v)o(e)h(been)f(added,)g(including)g(the)h(addition)f
(of)h(a)g(number)f(of)h(accessory)f(tools.)-364 1514
y(T)-7 b(oday)i(,)19 b(Aaron)g(continues)g(acti)n(v)o(e)h(de)n(v)o
(elopment)d(of)j(the)g(code.)-364 1844 y Fk(2)120 b(Bugs,)29
b(F)m(eatur)n(e)h(Requests,)g(and)h(P)o(atches)-364 2096
y Fj(2.1)99 b(Wher)n(e)26 b(can)g(I)e(get)h(help,)h(r)n(eport)g(b)n
(ugs)f(or)g(contact)h(the)g(de)o(v)o(elopers?)-364 2301
y Fl(The)20 b(best)h(place)f(to)g(get)g(help)g(or)g(report)f(a)h(b)n
(ug)g(is)h(the)f(Tcpreplay-Users)e(mailing)i(list:)-364
2401 y Fe(http://lists.sourceforge.net/lists/l)o(istinf)o(o/tcp)o
(replay)o(-)t(users)-364 2688 y Fj(2.2)99 b(What)25 b(inf)n(ormation)g
(should)g(I)g(pr)n(o)o(vide)h(when)f(I)g(r)n(eport)h(a)f(b)n(ug?)-364
2894 y Fl(One)18 b(of)g(the)g(most)g(frustrating)e(things)i(for)f(an)o
(y)g(de)n(v)o(eloper)f(trying)h(to)h(help)f(a)i(user)f(with)g(a)g
(problem)e(is)j(not)f(enough)e(information.)22 b(Please)c(be)g(sure)g
(to)g(include)-364 2993 y Fd(at)j(minimum)e Fl(the)i(follo)n(wing)d
(information,)g(ho)n(we)n(v)o(er)g(an)o(y)h(additional)g(information)f
(you)h(feel)h(may)g(be)g(helpful)f(will)i(be)f(appreciated.)-239
3226 y Fg(\017)41 b Fl(V)-9 b(ersion)19 b(information)f(\(output)h(of)g
(-V\))-239 3392 y Fg(\017)41 b Fl(Command)18 b(line)j(used)f(\(options)
f(and)g(ar)o(guments\))-239 3558 y Fg(\017)41 b Fl(Platform)19
b(\(Red)h(Hat)h(Linux)e(9)h(on)g(Intel,)g(Solaris)g(7)g(on)g(SP)-8
b(ARC,)22 b(etc\))-239 3724 y Fg(\017)41 b Fl(Error)19
b(message)h(\(if)g(a)n(v)n(ailable\))f(and/or)g(description)g(of)h
(problem)-239 3890 y Fg(\017)41 b Fl(If)20 b(possible,)f(attach)h(the)h
(pcap)e(\002le)i(used)f(\(compressed)e(with)j(bzip2)e(or)h(gzip)g
(preferred\))-364 4177 y Fj(2.3)99 b(I)25 b(ha)n(v)o(e)g(a)f(featur)n
(e)j(r)n(equest,)f(what)f(should)h(I)e(do?)-364 4383
y Fl(Let)f(us)h(kno)n(w!)31 b(Man)o(y)22 b(of)h(the)g(features)f(e)o
(xist)h(today)f(because)g(users)h(lik)o(e)g(you)f(ask)o(ed)h(for)f
(them.)32 b(T)-7 b(o)23 b(mak)o(e)g(a)g(feature)f(request,)g(you)g(can)
h(either)f(email)h(the)-364 4482 y(tcpreplay-users)18
b(mailing)i(list)h(\(see)f(abo)o(v)o(e\))e(or)i(\002ll)h(out)f(the)h
(feature)e(request)g(form)g(on)h(the)g(tcpreplay)f(SourceF)o(or)o(ge)e
(website.)-364 4770 y Fj(2.4)99 b(I')n(v)o(e)25 b(written)h(a)f(patch)h
(f)n(or)e(tcpr)n(eplay)-5 b(,)26 b(ho)o(w)f(can)g(I)g(submit)g(it?)-364
4975 y Fl(I'm)d(al)o(w)o(ays)h(willing)f(to)h(include)e(ne)n(w)i
(features)e(or)i(b)n(ug)e(\002x)o(es)i(submitted)f(by)g(users.)32
b(Y)-9 b(ou)21 b(may)h(email)h(me)f(directly)g(or)g(the)h
(tcpreplay-users)d(mailing)h(list.)-364 5075 y(Please)g
Fd(do)f(not)h Fl(use)g(the)f(P)o(atch)g(T)m(rack)o(er)f(on)h(the)g
(tcpreplay)f(SourceF)o(or)o(ge)e(web)j(site.)1929 5895
y(7)p eop end
%%Page: 8 8
TeXDict begin 8 7 bop -364 -281 a Fj(2.5)99 b(P)o(atch)26
b(r)n(equir)n(ements)-239 -92 y Fg(\017)41 b Fl(Be)25
b(a)o(w)o(are)g(that)g(submitting)f(a)h(patch,)g Fd(you)f(ar)m(e)h
(licensing)g(it)g(under)f(the)h(BSD)g(License)g Fl(as)g(written)g(in)g
(Appendix)e(A.)i(If)g(this)g(is)h(not)e(acceptable)g(to)-156
8 y(you,)19 b(then)h Fd(do)f(not)j Fl(send)e(me)g(the)g(patch!)-239
174 y Fg(\017)41 b Fl(If)20 b(you)f(wish)i(to)f(maintain)f(the)i(cop)o
(yright)d(o)o(v)o(er)h(your)f(code,)i(be)g(sure)g(that)g(your)f(patch)h
(contains)f(the)h(appropriate)e(information.)-239 340
y Fg(\017)41 b Fl(Please)21 b(pro)o(vide)d(a)i(description)f(of)h(what)
g(your)f(patch)h(does!)-239 506 y Fg(\017)41 b Fl(Comment)19
b(your)g(code!)24 b(I)d(w)o(on')o(t)e(use)h(code)g(I)g(can')o(t)f
(understand.)-239 672 y Fg(\017)41 b Fl(Mak)o(e)26 b(sure)f(you)h(are)g
(patching)e(a)i(branch)f(that)h(is)h(still)g(being)e(maintained.)41
b(Generally)25 b(that)h(means)g(that)g(most)g(recent)f(stable)i(and)e
(de)n(v)o(elopment)-156 772 y(branches)19 b(\(1.4)g(and)g(2.0)h(at)h
(the)f(time)g(of)g(this)h(writing\).)-239 938 y Fg(\017)41
b Fl(Mak)o(e)20 b(sure)g(you)f(are)h(patching)f(against)g(the)i(most)f
(recent)f(release)i(for)e(that)i(branch.)-239 1104 y
Fg(\017)41 b Fl(Please)21 b(submit)e(your)g(patch)h(in)g(the)h
(uni\002ed)e(dif)n(f)g(format)h(so)g(I)h(can)f(better)f(understand)f
(what)j(you')l(re)d(changing.)-239 1270 y Fg(\017)41
b Fl(Please)21 b(pro)o(vide)d(an)o(y)h(rele)n(v)n(ant)g(personal)g
(information)f(you')l(d)g(lik)o(e)j(listed)f(in)h(the)f(CREDITS)h
(\002le.)-364 1502 y(Please)g(note)f(that)g(while)g(I'm)g(al)o(w)o(ays)
h(interested)e(in)h(patches,)g(I)g(may)g(re)n(write)g(some)g(or)g(all)h
(of)f(your)e(submission)i(to)g(maintain)g(a)g(consistent)g(coding)f
(style.)-364 1851 y Fk(P)o(art)30 b(II)-364 2108 y Fh(Basics)-364
2420 y Fk(3)120 b(Basic)29 b(Tcpr)n(eplay)h(Usage)-364
2672 y Fj(3.1)99 b(Replaying)25 b(the)h(traf\002c)-364
2877 y Fl(T)-7 b(o)21 b(replay)e(a)h(gi)n(v)o(en)f(pcap)h(as)h(it)g(w)o
(as)g(captured)d(all)j(you)e(need)h(to)g(do)g(is)h(specify)f(the)g
(pcap)f(\002le)i(and)f(the)g(interf)o(ace)f(to)i(send)f(the)g(traf)n
(\002c)g(out)g(of:)-364 3026 y Fd(tcpr)m(eplay)f(-i)i(eth0)f(sample)o
(.pcap)-364 3314 y Fj(3.2)99 b(Replaying)25 b(at)g(differ)n(ent)i
(speeds)-364 3519 y Fl(Y)-9 b(ou)24 b(can)f(also)h(replay)f(the)h(traf)
n(\002c)g(at)g(dif)n(ferent)e(speeds)i(then)g(it)g(w)o(as)h(originally)
d(captured)2335 3489 y Ff(4)2366 3519 y Fl(.)37 b(T)-7
b(o)24 b(support)f(this,)i(tcpreplay)d(supports)h(four)g(dif)n(ferent)f
(\003ags:)-364 3619 y(-R,)f(-r)m(,)e(-m,)h(and)g(-p)-364
3768 y(Some)g(e)o(xamples:)-239 4001 y Fg(\017)41 b Fl(T)-7
b(o)20 b(replay)f(traf)n(\002c)h(as)h(f)o(ast)g(as)g(possible:)-156
4101 y Fd(tcpr)m(eplay)e(-R)h(-i)h(eth0)e(sample)o(.pcap)-239
4267 y Fg(\017)41 b Fl(T)-7 b(o)20 b(replay)f(traf)n(\002c)h(at)h
(10Mbps:)-156 4366 y Fd(tcpr)m(eplay)e(-r)i(10.0)e(-i)h(eth0)g(sample)o
(.pcap)-239 4532 y Fg(\017)41 b Fl(T)-7 b(o)20 b(replay)f(traf)n(\002c)
h(7.3)g(times)g(as)h(f)o(ast)g(as)g(it)g(w)o(as)g(captured:)-156
4632 y Fd(tcpr)m(eplay)e(-m)h(7.3)g(-i)g(eth0)g(sample)o(.pcap)-239
4798 y Fg(\017)41 b Fl(T)-7 b(o)20 b(replay)f(traf)n(\002c)h(at)h
(half-speed:)-156 4898 y Fd(tcpr)m(eplay)e(-m)h(0.5)g(-i)g(eth0)g
(sample)o(.pcap)-239 5064 y Fg(\017)41 b Fl(T)-7 b(o)20
b(replay)f(at)i(25.5)e(pack)o(ets)h(per)g(second:)-156
5163 y Fd(tcpr)m(eplay)f(-p)h(25.5)f(-i)h(eth0)g(sample)o(.pcap)p
-364 5233 1851 4 v -273 5289 a Fc(4)-244 5312 y Fb(Tcpreplay)f(mak)o
(es)e(a)h("best")g(ef)n(fort)g(to)g(replay)g(traf)n(\002c)h(at)f(the)f
(gi)n(v)o(en)i(rate,)f(b)o(ut)f(due)h(to)f(limitations)j(in)d(hardw)o
(are)j(or)d(the)g(pcap)i(\002le)e(itself,)h(it)g(may)f(not)h(be)f
(possible.)22 b(Capture)d(\002les)f(with)f(only)h(a)-364
5391 y(fe)n(w)g(pack)o(ets)h(in)e(them)h(are)f(especially)j
(susceptible)g(to)e(this.)1929 5895 y Fl(8)p eop end
%%Page: 9 9
TeXDict begin 9 8 bop -364 -281 a Fj(3.3)99 b(Replaying)25
b(the)h(same)e(\002le)i(o)o(v)o(er)f(and)g(o)o(v)o(er)g(again)-364
-80 y Fl(Using)20 b(the)h(loop)e(\003ag)h(\(-l\))g(you)f(can)h(specify)
g(that)g(a)h(pcap)e(\002le)i(will)g(be)f(sent)h(tw)o(o)f(or)g(more)f
(times)2476 -110 y Ff(5)2509 -80 y Fl(:)-239 138 y Fg(\017)41
b Fl(T)-7 b(o)20 b(replay)f(the)i(sample.pcap)d(\002le)j(10)f(times:)
-156 238 y Fd(tcpr)m(eplay)f(-l)i(10)e(-i)i(eth0)e(sample)o(.pcap)-239
399 y Fg(\017)41 b Fl(T)-7 b(o)20 b(replay)f(the)i(sample.pcap)d(an)i
(in\002nitely)g(or)g(until)g(CTRL-C)h(is)g(pressed:)-156
499 y Fd(tcpr)m(eplay)e(-l)i(0)f(-i)g(eth0)g(sample)o(.pcap)-364
780 y Fj(3.4)99 b(Using)25 b(Con\002guration)h(Files)-364
982 y Fl(Tcpreplay)18 b(of)n(fers)h(the)h(options)f(of)g(specifying)f
(con\002guration)f(options)i(in)h(a)g(con\002g)f(\002le)i(in)f
(addition)e(to)i(the)g(traditional)f(command)e(line.)25
b(Each)20 b(con\002gura-)-364 1081 y(tion)g(option)g(has)g(an)h(equi)n
(v)n(alent)e(con\002g)g(\002le)i(option)f(which)g(is)h(listed)g(in)g
(the)f(tcpreplay)f(man)h(page.)25 b(T)-7 b(o)21 b(specify)f(the)g
(con\002guration)e(\002le)j(you')l(d)e(lik)o(e)i(to)f(use,)-364
1181 y(use)h(the)f(-f)g(<\002lename>)f(option.)-364 1326
y(Con\002guration)e(\002les)j(ha)n(v)o(e)e(one)g(option)g(per)g(line,)h
(and)f(lines)i(be)o(ginning)c(with)j(the)g(pound)e(sign)h(\(#\))h(are)f
(considered)f(comments)h(and)g(ignored.)23 b(An)c(e)o(xample)-364
1426 y(con\002g)h(\002le)g(follo)n(ws:)-364 1571 y(#)g(send)g(traf)n
(\002c)g(out)g('eth0')-364 1671 y(intf)g(eth0)-364 1870
y(#)g(loop)g(5)g(times)-364 1969 y(loop)g(5)-364 2169
y(#)g(send)g(traf)n(\002c)g(2x)g(as)h(f)o(ast)-364 2268
y(multiplier)e(2)-364 2468 y(#)h(pad)g(an)o(y)g(pack)o(ets)f(out)h(to)h
(their)f(original)f(size)h(if)h(the)o(y)e(were)h(truncated)f(during)g
(capture)-364 2567 y(untruncate)f(pad)-364 3011 y(Y)-9
b(ou)20 b(w)o(ould)f(then)h(e)o(x)o(ecute:)-364 3111
y Fd(tcpr)m(eplay)f(-f)i(mycon\002g\002le)d(sample)o(.pcap)-364
3455 y Fk(P)o(art)30 b(III)-364 3708 y Fh(Adv)n(anced)44
b(Usage)-364 4016 y Fk(4)120 b(Output:)37 b(Interfaces,)29
b(P)o(ack)o(ets)h(&)f(Files)-364 4263 y Fj(4.1)99 b(Replaying)25
b(on)g(multiple)g(interfaces)-364 4464 y Fl(Tcpreplay)e(can)i(also)h
(split)f(traf)n(\002c)g(so)h(that)f(each)g(side)g(of)g(a)g(connection)e
(is)j(sent)f(out)g(a)h(dif)n(ferent)d(interf)o(ace)2858
4434 y Ff(6)2890 4464 y Fl(.)40 b(In)25 b(order)f(to)h(do)g(this,)h
(tcpreplay)e(needs)g(the)-364 4564 y(name)c(of)g(the)g(second)f(interf)
o(ace)h(\(-j\))f(and)h(a)h(w)o(ay)f(to)g(split)h(the)f(traf)n(\002c.)25
b(Currently)-5 b(,)18 b(there)i(are)g(tw)o(o)g(w)o(ays)h(to)f(split)h
(traf)n(\002c:)-260 4782 y(1.)41 b(-C)21 b(=)f(split)h(traf)n(\002c)f
(by)g(source)f(IP)i(address)e(which)h(is)h(speci\002ed)f(in)g(CIDR)i
(notation)-260 4944 y(2.)41 b(-c)20 b(=)h(split)f(traf)n(\002c)g
(according)e(to)j(a)f(tcpprep)f(cache\002le)1434 4913
y Ff(7)-364 5161 y Fl(When)i(splitting)g(traf)n(\002c,)g(it)h(is)g
(important)e(to)h(remember)f(that)h(traf)n(\002c)g(that)g(matches)g
(the)g(\002lter)h(is)g(sent)g(out)f(the)g(primary)f(interf)o(ace)g
(\(-i\).)28 b(In)21 b(this)g(case,)h(when)-364 5261 y(splitting)e(traf)
n(\002c)g(by)g(source)f(IP)i(address,)e(you)h(pro)o(vide)e(a)i(list)i
(of)e(netw)o(orks)f(in)h(CIDR)h(notation.)j(F)o(or)c(e)o(xample:)p
-364 5328 1851 4 v -273 5383 a Fc(5)-244 5406 y Fb(Looping)g(\002les)f
(resets)h(internal)i(counters)f(which)f(control)h(the)f(speed)g(that)g
(the)g(\002le)g(is)f(replayed.)29 b(Also)19 b(because)i(the)f(\002le)g
(has)f(to)h(be)f(closed)i(and)f(re-opened,)h(an)e(added)i(delay)g
(between)g(the)-364 5485 y(last)d(and)g(\002rst)f(pack)o(et)i(may)e
(occur)l(.)-273 5543 y Fc(6)-244 5566 y Fb(Note)g(that)i(you)e(can)h
(also)f(use)g(the)h(follo)n(wing)h(options)g(to)e(split)h(traf)n(\002c)
h(into)f(tw)o(o)f(\002les)g(using)h(-w)f(and)g(-W)g(which)g(are)h
(described)h(later)g(on)e(in)g(this)h(F)-5 b(A)l(Q.)-273
5622 y Fc(7)-244 5646 y Fb(F)o(or)17 b(information)i(on)e(generating)j
(tcpprep)f(cache)f(\002les,)f(see)h(the)f(section)i(on)e(tcpprep.)1929
5895 y Fl(9)p eop end
%%Page: 10 10
TeXDict begin 10 9 bop -239 -281 a Fg(\017)41 b Fl(T)-7
b(o)20 b(send)g(traf)n(\002c)g(from)f(10.0.0.0/8)e(out)j(eth0)g(and)g
(e)n(v)o(erything)d(else)k(out)f(eth1:)-156 -181 y Fd(tcpr)m(eplay)f
(-C)i(10.0.0.0/8)c(-i)j(eth0)g(-j)h(eth1)e(sample)o(.pcap)-239
-24 y Fg(\017)41 b Fl(T)-7 b(o)20 b(send)g(traf)n(\002c)g(from)f
(10.1.0.0/24)e(and)i(10.2.0.0/20)e(out)j(eth0)g(and)f(e)n(v)o(erything)
f(else)j(out)f(eth1:)-156 76 y Fd(tcpr)m(eplay)f(-C)i
(10.1.0.0/24,10.2.0)o(.0)o(/20)14 b(-i)21 b(eth0)e(-j)i(eth1)f(sample)o
(.pcap)-239 233 y Fg(\017)41 b Fl(After)20 b(using)f(tcpprep)g(to)h
(generate)f(a)i(cache)f(\002le,)g(you)g(can)g(use)g(it)h(to)f(split)h
(traf)n(\002c)f(between)f(tw)o(o)i(interf)o(aces)e(lik)o(e)i(this:)-156
332 y Fd(tcpr)m(eplay)e(-c)h(sample)o(.cac)o(he)e(-i)j(eth0)e(-j)i
(eth1)f(sample)o(.pcap)-364 607 y Fj(4.2)99 b(Selecti)o(v)o(ely)26
b(sending)f(or)g(dr)n(opping)h(pack)o(ets)-364 803 y
Fl(Sometimes,)20 b(you)f(w)o(ant)h(to)h(do)e(some)i(post-capture)d
(\002ltering)h(of)h(pack)o(ets.)25 b(Tcpreplay)18 b(let')-5
b(s)21 b(you)f(ha)n(v)o(e)f(some)h(control)f(o)o(v)o(er)g(which)h(pack)
o(ets)g(get)g(sent.)-260 1005 y(1.)41 b(-M)20 b(=)h(disables)f(sending)
f(of)h(martian)f(pack)o(ets.)25 b(By)20 b(de\002nition,)f(martian)h
(pack)o(ets)g(ha)n(v)o(e)f(a)i(source)e(IP)i(of)f(0.x.x.x,)d
(127.x.x.x,)g(or)j(255.x.x.x)-260 1162 y(2.)41 b(-x)20
b(=)g(send)g(pack)o(ets)g(which)g(match)f(a)i(speci\002c)f(pattern)-260
1319 y(3.)41 b(-X)20 b(=)h(send)f(pack)o(ets)g(which)f(do)h(not)g
(match)f(a)i(speci\002c)f(pattern)-364 1520 y(Both)j(-x)g(and)f(-X)h
(support)e(a)j(v)n(ariety)d(of)i(pattern)f(matching)f(types.)33
b(These)22 b(types)h(are)g(speci\002ed)f(by)h(a)g(single)g(character)m
(,)e(follo)n(wed)h(by)g(a)h(colon,)g(follo)n(wed)-364
1620 y(by)d(the)g(pattern.)k(The)c(follo)n(wing)f(pattern)g(matching)g
(types)h(are)g(a)n(v)n(ailable:)-260 1821 y(1.)41 b(S)21
b(-)f(Source)f(IP)-156 1921 y(P)o(attern)g(is)j(a)e(comma)f(delimited)h
(CIDR)h(notation)-260 2078 y(2.)41 b(D)20 b(-)h(Destination)e(IP)-156
2178 y(P)o(attern)g(is)j(a)e(comma)f(delimited)h(CIDR)h(notation)-260
2335 y(3.)41 b(B)21 b(-)f(Both)h(source)e(and)h(destination)f(IP)h
(must)h(match)-156 2434 y(P)o(attern)e(is)j(a)e(comma)f(delimited)h
(CIDR)h(notation)-260 2591 y(4.)41 b(E)20 b(-)h(Either)e(source)h(or)g
(destination)f(IP)h(must)h(match)-156 2691 y(P)o(attern)e(is)j(a)e
(comma)f(delimited)h(CIDR)h(notation)-260 2848 y(5.)41
b(P)21 b(-)f(A)h(list)g(of)f(pack)o(et)g(numbers)e(from)h(the)i(pcap)e
(\002le.)-156 2948 y(P)o(attern)g(is)j(a)e(series)h(of)f(numbers,)e
(separated)i(by)f(commas)h(or)g(dashes.)-260 3105 y(6.)41
b(F)21 b(-)f(BPF)i(syntax)d(\(same)h(as)h(used)f(in)g(tcpdump\).)-156
3205 y(Filter)g(must)h(be)f(quoted)f(and)g(is)i(only)f(supported)e
(with)i(-x)1544 3174 y Ff(8)1577 3205 y Fl(.)-364 3406
y(Examples:)-239 3607 y Fg(\017)41 b Fl(T)-7 b(o)20 b(only)f(send)h
(traf)n(\002c)g(that)h(is)g(too)f(and)f(from)g(a)i(host)f(in)h
(10.0.0.0/8:)-156 3707 y Fd(tcpr)m(eplay)e(-x)h(B:10.0.0.0/8)d(-i)j
(eth0)g(sample)o(.pcap)-239 3864 y Fg(\017)41 b Fl(T)-7
b(o)20 b(not)g(send)g(traf)n(\002c)g(that)g(is)h(too)f(or)g(from)f(a)i
(host)f(in)g(10.0.0.0/8:)-156 3963 y Fd(tcpr)m(eplay)f(-X)h
(E:10.0.0.0/8)d(-i)j(eth0)g(sample)o(.pcap)-239 4121
y Fg(\017)41 b Fl(T)-7 b(o)20 b(send)g(e)n(v)o(ery)f(pack)o(et)g(e)o
(xcept)h(the)g(\002rst)h(10)f(pack)o(ets:)-156 4220 y
Fd(tcpr)m(eplay)f(-X)h(P:1-10)e(-i)j(eth0)f(sample)o(.pcap)-239
4377 y Fg(\017)41 b Fl(T)-7 b(o)20 b(only)f(send)h(the)h(\002rst)g(50)e
(pack)o(ets)h(follo)n(wed)f(by)h(pack)o(ets:)25 b(100,)19
b(150,)g(200)g(and)h(250:)-156 4477 y Fd(tcpr)m(eplay)f(-x)h
(P:1-50,100,150,20)o(0,)o(25)o(0)15 b(-i)20 b(eth0)g(sample)o(.pcap)
-239 4634 y Fg(\017)41 b Fl(T)-7 b(o)20 b(only)f(send)h(TCP)h(pack)o
(ets)f(from)f(10.0.0.1:)-156 4734 y(tcpreplay)f(-x)i(F:')o(tcp)g(and)g
(host)g(10.0.0.1')d(-i)j(eth0)g(sample.pcap)-364 5008
y Fj(4.3)99 b(Replaying)25 b(only)g(a)f(few)i(pack)o(ets)-364
5205 y Fl(Using)20 b(the)h(limit)f(pack)o(ets)g(\003ag)g(\(-L\))g(you)f
(can)h(specify)g(that)g(tcpreplay)f(will)h(only)g(send)g(at)g(most)h(a)
f(speci\002ed)g(number)f(of)h(pack)o(ets.)-239 5406 y
Fg(\017)41 b Fl(T)-7 b(o)20 b(send)g(at)h(most)f(100)f(pack)o(ets:)-156
5506 y Fd(tcpr)m(eplay)g(-i)i(eth0)e(-L)i(100)e(sample)o(.pcap)p
-364 5567 1851 4 v -273 5622 a Fc(8)-244 5646 y Fb(Note)e(that)i(if)e
(you)g(w)o(ant)h(to)f(send)h(all)g(the)g(pack)o(ets)h(which)f(do)f(not)
g(match)h(a)f(bpf)g(\002lter)m(,)h(all)g(you)g(ha)o(v)o(e)f(to)h(do)f
(is)f(ne)o(gate)j(the)f(bpf)f(\002lter)l(.)22 b(See)c(the)f
(tcpdump\(1\))i(man)e(page)h(for)f(more)g(info.)1908
5895 y Fl(10)p eop end
%%Page: 11 11
TeXDict begin 11 10 bop -364 -281 a Fj(4.4)99 b(Skipping)26
b(the)g(\002rst)g(bytes)f(in)g(a)g(pcap)g(\002le)-364
-75 y Fl(If)c(you)g(w)o(ant)g(to)h(skip)f(the)h(be)o(ginning)c(of)j(a)h
(pcap)f(\002le,)h(you)e(can)h(use)h(the)f(of)n(fset)g(\003ag)h(\(-o\))e
(to)i(skip)f(a)h(speci\002ed)f(number)e(of)i(bytes)h(and)e(start)i
(sending)e(on)h(the)-364 24 y(ne)o(xt)f(pack)o(et.)-239
257 y Fg(\017)41 b Fl(T)-7 b(o)20 b(skip)g(15Kb)g(into)f(the)i(pcap)e
(\002le)i(and)f(start)g(sending)f(pack)o(ets)h(from)f(there:)-156
356 y Fd(tcpr)m(eplay)g(-i)i(eth0)e(-o)h(15000)e(sample)o(.pcap)-364
644 y Fj(4.5)99 b(Replaying)25 b(pack)o(ets)h(which)g(ar)n(e)f(bigger)g
(then)h(the)g(MTU)-364 849 y Fl(Occasionally)-5 b(,)26
b(you)f(might)g(\002nd)g(yourself)f(trying)h(to)h(replay)f(a)h(pcap)f
(\002le)h(which)f(contains)g(pack)o(ets)h(which)f(are)h(lar)o(ger)e
(then)h(the)h(MTU)g(for)f(the)h(sending)-364 949 y(interf)o(ace.)e
(This)19 b(might)f(be)g(due)g(to)h(the)g(pack)o(ets)f(being)g(captured)
f(on)h(the)h(loopback)d(interf)o(ace)i(or)g(on)h(a)g(1000Mbps)d
(ethernet)i(interf)o(ace)f(supporting)g(\223jumbo)-364
1049 y(frames\224.)36 b(I')l(v)o(e)23 b(e)n(v)o(en)g(seen)i(pack)o(ets)
e(which)h(are)g(1500)f(bytes)h(b)n(ut)g(contain)f(both)g(an)h(ethernet)
f(header)g(and)h(trailer)g(which)f(b)n(umps)h(the)g(total)g(frame)f
(size)i(to)-364 1148 y(1518)19 b(which)h(is)h(4)f(bytes)g(too)g(lar)o
(ge.)-364 1298 y(By)k(def)o(ault,)g(tcpreplay)e(will)i(skip)g(these)f
(pack)o(ets)h(and)f(not)g(send)g(them.)35 b(Alternati)n(v)o(ely)-5
b(,)22 b(you)h(can)g(specify)g(the)h(-T)f(\003ag)h(to)g(truncate)f
(these)g(pack)o(ets)h(to)f(the)-364 1397 y(MTU)f(and)f(then)g(send)h
(them.)29 b(Of)21 b(course)g(this)i(may)e(in)m(v)n(alidate)f(your)g
(testing,)i(b)n(ut)g(it)g(has)g(pro)o(v)o(en)e(useful)h(in)g(certain)h
(situations.)29 b(Also,)22 b(when)f(this)h(feature)-364
1497 y(is)f(enabled,)e(tcpreplay)g(will)i(automatically)d(recalculate)i
(the)g(IP)g(and)g(TCP)-9 b(,)21 b(UDP)f(or)g(ICMP)h(checksums)e(as)i
(needed.)j(Example:)-364 1646 y Fd(tcpr)m(eplay)19 b(-i)i(eth0)f(-T)g
(sample)o(.pcap)-364 1934 y Fj(4.6)99 b(Writing)25 b(pack)o(ets)h(to)f
(a)f(\002le)-364 2139 y Fl(It')-5 b(s)22 b(not)g(al)o(w)o(ays)g
(necessary)f(to)g(write)h(pack)o(ets)f(to)h(the)g(netw)o(ork.)27
b(Since)22 b(tcpreplay)e(has)i(so)g(man)o(y)e(features)h(which)g
(modify)f(and)h(select)h(which)f(pack)o(ets)g(are)-364
2239 y(sent,)h(it)g(is)g(occasionally)e(useful)h(to)g(sa)n(v)o(e)h
(these)g(changes)e(to)h(another)f(pcap)h(\002le)h(for)f(comparison.)26
b(Rather)21 b(then)g(running)e(a)j(separate)f(tcpdump)e(process)i(to)
-364 2339 y(capture)e(the)i(pack)o(ets,)e(tcpreplay)g(no)n(w)g
(supports)h(output)f(directly)g(to)h(a)h(\002le.)26 b(Example:)-364
2488 y Fd(tcpr)m(eplay)19 b(-i)i(eth0)f(-w)g(output.pcap)e(-F)i(-u)g
(pad)f(-x)h(E:10.0.0.0/8)d(input1.pcap)g(input2.pcap)g(input3.pcap)-364
2637 y Fl(Notice)h(that)h(specifying)e(an)h(interf)o(ace)f(is)j(still)f
(required)e(\(required)f(for)i(v)n(arious)f(internal)g(functions\),)g
(b)n(ut)h(all)h(the)g(pack)o(ets)f(will)h(be)f(written)g(to)h
Fd(output.pcap)p Fl(.)-364 2787 y(Y)-9 b(ou)20 b(can)g(also)g(split)h
(traf)n(\002c)f(into)g(tw)o(o)g(\002les)i(by)d(using)h(-W)h(<2nd)e
(output)g(\002le>.)-364 3074 y Fj(4.7)99 b(Extracting)26
b(A)n(pplication)f(Data)f(\(Lay)o(er)i(7\))-364 3280
y Fl(Ne)n(w)21 b(to)g(v)o(ersion)f(2.0)g(is)i(the)e(ability)h(to)g(e)o
(xtract)f(the)h(application)e(layer)i(data)f(from)g(the)h(pack)o(ets)f
(and)h(write)g(them)f(to)h(a)g(\002le.)28 b(In)20 b(the)h(man)f(page,)g
(we)i(call)f(this)-364 3379 y(\223data)d(dump)g(mode\224)f(which)h(is)h
(enabled)f(with)g(-D.)h(It')-5 b(s)19 b(important)e(to)i(specify)e(-D)i
(before)e(-w)i(\(and)e(-W)j(if)e(you')l(re)f(splitting)h(data)h(into)f
(tw)o(o)h(\002les\).)25 b(Example:)-364 3529 y Fd(tcpr)m(eplay)19
b(-D)i(-i)f(eth0)g(-j)g(eth0)g(-w)h(clientdata)e(-W)h(server)m(data)g
(-C)h(10.0.0.0/24)c(sample)o(.pcap)-364 3816 y Fj(4.8)99
b(Replaying)25 b(Li)o(v)o(e)g(T)-7 b(raf\002c)-364 4022
y Fl(Y)e(ou)23 b(can)h(no)n(w)f(replay)g(li)n(v)o(e)g(traf)n(\002c)h
(snif)n(fed)f(on)g(one)g(netw)o(ork)g(interf)o(ace)g(and)g(replay)g(it)
h(on)g(another)e(interf)o(ace)h(using)g(the)h(-S)g(\003ag)g(to)g
(indicate)f(snif)n(f)g(mode)-364 4121 y(and)18 b(the)h(appropriate)d
(snaplen)i(in)h(bytes)f(\(0)g(denotes)g(the)h(entire)f(pack)o(et\).)23
b(Y)-9 b(ou)18 b(can)g(also)h(enabling)e(bi-directional)g(traf)n(\002c)
h(using)g(the)h(bridge)e(mode)h(\003ag:)24 b(-b)m(.)-364
4271 y(N)r Fb(O)q(T)t(E)t Fl(:)43 b(It)28 b(is)h(critical)f(for)g(your)
e(sanity)i(\(and)f(to)h(pre)n(v)o(ent)e(your)h(murder)f(by)i(your)e
(netw)o(ork)h(administrators\))f(that)i(the)g(input)f(interf)o(ace)g
(and)h(the)g(output)-364 4371 y(interf)o(ace)21 b(be)h(on)f(separate)g
(netw)o(orks)g(and)g(additionally)f(that)i(no)g(other)f(netw)o(ork)f
(de)n(vices)h(\(such)h(as)g(bridges,)f(switches,)h(routers,)f(etc\))h
(be)g(connecting)d(the)-364 4470 y(tw)o(o)i(netw)o(orks,)e(else)i(you)e
(will)i(surely)e(get)i(a)f(netw)o(orkstorm)e(the)j(lik)o(es)f(that)h
(ha)n(v)o(e)e(not)h(been)g(seen)g(for)f(years.)-239 4703
y Fg(\017)41 b Fl(Send)20 b(pack)o(ets)f(snif)n(fed)h(on)f(eth0)h(out)g
(eth1:)-156 4802 y Fd(tcpr)m(eplay)f(-i)i(eth1)e(-S)h(0)g(eth0)-239
4968 y Fg(\017)41 b Fl(Bridge)20 b(tw)o(o)g(subnets)g(connected)e(to)i
(eth0)g(and)g(eth1:)-156 5068 y Fd(tcpr)m(eplay)f(-i)i(eth0)e(-j)i
(eth1)e(-b)h(-S)g(0)-364 5300 y Fl(By)28 b(def)o(ault,)f(tcpreplay)f
(listens)i(in)f(promiscuous)e(mode)h(on)g(the)h(speci\002ed)g(interf)o
(ace,)g(ho)n(we)n(v)o(er)e(if)j(you)e(only)g(w)o(ant)h(to)g(send)g
(unicasts)g(directed)f(for)g(the)-364 5400 y(local)20
b(system)g(and)g(broadcasts,)e(you)h(can)h(specify)g(the)f
(\223not_nosy\224)f(option)h(in)h(the)g(con\002guration)d(\002le)k(or)f
(-n)f(on)h(the)g(command)e(line.)25 b(Note)20 b(that)g(if)g(another)
-364 5500 y(program)d(has)i(already)f(placed)g(the)g(interf)o(ace)g(in)
h(promiscuous)e(mode,)h(the)h(-n)f(\003ag)h(will)h(ha)n(v)o(e)e(no)g
(ef)n(fect,)h(so)g(you)f(may)g(w)o(ant)h(to)g(use)g(the)g(-x)f(or)h(-X)
g(ar)o(gument)-364 5599 y(to)i(limit)f(pack)o(ets.)1908
5895 y(11)p eop end
%%Page: 12 12
TeXDict begin 12 11 bop -364 -281 a Fj(4.9)99 b(Replaying)25
b(P)o(ack)o(et)h(Captur)n(e)g(F)n(ormats)e(Other)h(Than)h(Libpcap)-364
-75 y Fl(There)20 b(are)h(about)f(as)h(man)o(y)e(dif)n(ferent)h
(capture)f(\002le)j(formats)d(as)j(there)e(are)h(snif)n(fers.)26
b(In)20 b(the)h(interest)g(of)f(simplicity)-5 b(,)20
b(tcpreplay)f(only)h(supports)g(libpcap)4129 -105 y Ff(9)4160
-75 y Fl(.)27 b(If)-364 24 y(you)19 b(w)o(ould)h(lik)o(e)g(to)g(replay)
f(a)i(\002le)f(in)g(one)g(of)g(these)g(multitude)f(of)g(formats,)g(the)
h(e)o(xcellent)f(open)g(source)h(tool)f(Ethereal)h(easily)g(allo)n(ws)g
(you)f(to)h(con)m(v)o(ert)e(it)j(to)-364 124 y(libpcap.)j(F)o(or)c
(instance,)g(to)g(con)m(v)o(ert)e(a)j(\002le)g(in)f(Sun')-5
b(s)20 b(snoop)f(format)g(to)i(libpcap,)e(issue)h(the)h(command:)-364
273 y Fd(tether)m(eal)f(-r)h(blah.snoop)c(-w)k(blah.pcap)-364
423 y Fl(and)f(replay)f(the)h(resulting)g(\002le.)-364
710 y Fj(4.10)99 b(Replaying)25 b(Client)g(T)-7 b(raf\002c)26
b(to)f(a)f(Ser)o(v)o(er)-364 916 y Fl(A)30 b(common)d(question)i(on)f
(the)i(tcpreplay-users)d(list)j(is)g(ho)n(w)f(does)g(one)g(replay)f
(the)h(client)h(side)f(of)g(a)h(connection)d(back)i(to)g(a)h(serv)o(er)
-5 b(.)52 b(Unfortunately)-5 b(,)-364 1015 y(tcpreplay)24
b(doesn')o(t)f(support)h(this)h(right)g(no)n(w)-5 b(.)38
b(The)25 b(major)f(problem)g(concerns)f(syncing)h(up)h(TCP)h(Seq/Ack)e
(numbers)g(which)g(will)i(be)f(dif)n(ferent.)38 b(ICMP)-364
1115 y(also)25 b(often)e(contains)h(IP)g(header)f(information)f(which)i
(w)o(ould)f(need)g(to)i(be)f(adjusted.)36 b(About)23
b(the)i(only)e(thing)g(that)i(could)e(be)h(easy)g(to)h(do)e(is)j(UDP)-9
b(,)24 b(which)-364 1215 y(isn')o(t)c(usually)g(requested.)-364
1364 y(This)h(is)g(ho)n(we)n(v)o(er)d(a)j(feature)e(that)h(we')l(re)g
(looking)e(into)i(implementing)e(in)j(the)f(\003o)n(wreplay)f(utility)
-5 b(.)24 b(If)c(you')l(re)f(interested)g(in)i(helping)d(w)o(ork)i(on)g
(this)h(feature,)-364 1464 y(please)16 b(contact)f(us)i(and)e(we')l(d)g
(be)h(more)f(then)h(happ)o(y)e(to)i(w)o(ork)g(with)g(you.)22
b(At)17 b(this)f(time)g(ho)n(we)n(v)o(er)m(,)e(we)j(don')o(t)d(ha)n(v)o
(e)h(an)h(ET)-8 b(A)16 b(when)g(this)g(will)h(be)e(implemented,)-364
1563 y(so)21 b(don')o(t)d(bother)h(asking.)-364 1851
y Fj(4.11)99 b(Decoding)26 b(P)o(ack)o(ets)-364 2056
y Fl(If)d(the)g(tcpdump)e(binary)g(is)j(installed)f(on)f(your)g(system)
h(when)f(tcpreplay)f(is)j(compiled,)e(it)h(will)h(allo)n(w)f(you)f(to)h
(decode)e(pack)o(ets)i(as)g(the)o(y)f(are)h(sent)g(without)-364
2156 y(running)18 b(tcpdump)h(in)h(a)h(separate)e(windo)n(w)g(or)h(w)o
(orrying)f(about)g(it)i(capturing)d(pack)o(ets)i(which)g(weren')o(t)e
(sent)j(by)f(tcpreplay)-5 b(.)-239 2388 y Fg(\017)41
b Fl(Decode)19 b(pack)o(ets)h(as)h(the)o(y)e(are)h(sent:)-156
2488 y Fd(tcpr)m(eplay)f(-i)i(eth0)e(-v)h(sample)o(.pcap)-239
2654 y Fg(\017)41 b Fl(Decode)19 b(pack)o(ets)h(with)g(the)h(link)e(le)
n(v)o(el)h(header:)-156 2754 y Fd(tcpr)m(eplay)f(-i)i(eth0)e(-v)h(-A)h
(\223-e\224)f(sample)o(.pcap)-239 2920 y Fg(\017)41 b
Fl(Fully)20 b(decode)f(and)g(send)h(one)g(pack)o(et)g(at)g(a)h(time:)
-156 3019 y Fd(tcpr)m(eplay)e(-i)i(eth0)e(-v)h(-1)g(-A)h(\223-s0)f(-e)o
(vvvxX\224)f(sample)o(.pcap)-364 3252 y Fl(Note)f(that)f(tcpreplay)f
(automatically)g(applies)i(the)f(-n)h(\003ag)f(to)h(disable)f(DNS)h
(lookups)e(which)h(w)o(ould)g(slo)n(w)h(do)n(wn)f(tcpdump)e(too)i(much)
g(to)h(mak)o(e)f(it)h(ef)n(fecti)n(v)o(e.)-364 3582 y
Fk(5)120 b(P)o(ack)o(et)29 b(Editing)-364 3834 y Fj(5.1)99
b(Rewriting)25 b(MA)-5 b(C)25 b(addr)n(esses)-364 4039
y Fl(If)c(you)f(e)n(v)o(er)g(w)o(ant)h(to)g(send)g(traf)n(\002c)f(to)h
(another)f(de)n(vice)g(on)g(a)h(switched)g(LAN,)g(you)f(may)g(need)g
(to)h(change)f(the)h(destination)f(MA)m(C)h(address)f(of)h(the)g(pack)o
(ets.)-364 4139 y(Tcpreplay)d(allo)n(ws)j(you)e(to)h(set)h(the)f
(destination)f(MA)m(C)i(for)e(each)h(interf)o(ace)f(independently)e
(using)j(the)g(-I)g(and)f(-J)i(switches.)k(As)c(of)f(v)o(ersion)f
(2.1.0,)f(you)i(can)-364 4239 y(also)h(specify)e(the)h(source)g(MA)m(C)
g(via)h(-k)f(and)f(-K.)h(Example:)-239 4471 y Fg(\017)41
b Fl(T)-7 b(o)15 b(send)g(traf)n(\002c)g(out)g(eth0)g(with)g(a)h
(destination)e(MA)m(C)h(of)g(your)f(router)g(\(00:00:01:02:03:04\))c
(and)15 b(the)g(source)f(MA)m(C)i(of)f(the)g(serv)o(er)f
(\(00:20:30:40:50:60\):)-156 4571 y Fd(tcpr)m(eplay)19
b(-i)i(eth0)e(-I)h(00:00:01:02:03:0)o(4)14 b(-k)21 b(00:20:30:40:50)o
(:60)14 b(sample)o(.pcap)-239 4737 y Fg(\017)41 b Fl(T)-7
b(o)20 b(split)h(traf)n(\002c)f(between)f(internal)h(\(10.0.0.0/24\))c
(and)j(e)o(xternal)g(addresses)h(and)g(to)g(send)g(that)g(traf)n(\002c)
g(to)h(the)f(tw)o(o)g(interf)o(aces)g(of)g(a)g(\002re)n(w)o(all:)-156
4836 y Fd(tcpr)m(eplay)f(-i)i(eth0)e(-j)i(eth1)e(-I)h
(00:01:00:00:AA:01)14 b(-J)20 b(00:01:00:00:AA:02)14
b(-C)21 b(10.0.0.0/24)16 b(sample)o(.pcap)p -364 4906
1851 4 v -273 4962 a Fc(9)-244 4985 y Fb(Note)h(that)i(some)e(v)o
(ersions)h(of)e(tcpreplay)k(prior)e(to)f(1.4)g(also)g(supported)i(the)f
(Solaris)g(snoop)f(format.)1908 5895 y Fl(12)p eop end
%%Page: 13 13
TeXDict begin 13 12 bop -364 -281 a Fj(5.2)99 b(Randomizing)25
b(IP)g(addr)n(esses)-364 -81 y Fl(Occasionally)-5 b(,)25
b(it)h(is)g(necessary)e(to)h(ha)n(v)o(e)g(tcpreplay)e(re)n(write)i(the)
g(source)f(and)h(destination)f(IP)h(addresses,)h(yet)f(maintain)f(the)h
(client/serv)o(er)f(relationship.)-364 19 y(Such)17 b(a)h(case)g(might)
e(be)i(ha)n(ving)e(multiple)g(copies)h(of)g(tcpreplay)f(running)f(at)j
(the)g(same)f(time)h(using)e(the)i(same)f(pcap)g(\002le)h(while)f
(trying)f(to)i(stress)g(test)g(\002re)n(w)o(all,)-364
118 y(IDS)k(or)e(other)g(stateful)h(de)n(vice.)27 b(If)21
b(you)f(didn')o(t)f(change)h(the)h(source)f(and)g(destination)g(IP)i
(addresses,)e(the)h(de)n(vice)f(under)g(test)i(w)o(ould)e(get)h
(confused)e(since)j(it)-364 218 y(w)o(ould)d(see)h(multiple)f(copies)h
(of)f(the)h(same)g(connection)d(occurring)h(at)i(the)f(same)h(time.)25
b(In)20 b(order)e(to)i(accomplish)e(this,)i(tcpreplay)e(accepts)i(a)g
(user)g(speci\002ed)-364 318 y(seed)h(which)e(is)j(used)e(to)g
(generate)f(pseudo-random)d(IP)21 b(addresses.)k(Also,)20
b(when)g(this)h(feature)e(is)i(enabled,)e(tcpreplay)g(will)i
(automatically)e(recalculate)g(the)-364 417 y(IP)i(and)e(TCP)-9
b(,)21 b(UDP)g(or)f(ICMP)g(checksums)f(as)i(needed.)j(Example:)-364
561 y Fd(tcpr)m(eplay)19 b(-i)i(eth0)f(-s)g(1239)f(sample)o(.pcap)f(&)
-364 661 y(tcpr)m(eplay)h(-i)i(eth0)f(-s)g(76)g(sample)o(.pcap)e(&)-364
760 y(tcpr)m(eplay)h(-i)i(eth0)f(-s)g(239)g(sample)o(.pcap)e(&)-364
860 y(tcpr)m(eplay)h(-i)i(eth0)f(sample)o(.pcap)-364
1139 y Fj(5.3)99 b(Replaying)25 b(\(de\)truncated)j(pack)o(ets)-364
1339 y Fl(Occasionally)-5 b(,)30 b(it)g(is)g(necessary)f(to)h(replay)e
(traf)n(\002c)h(which)g(has)g(been)g(truncated)f(by)h(tcpdump.)50
b(This)30 b(occurs)e(when)h(the)g(tcpdump)f(snaplen)g(is)i(smaller)-364
1439 y(then)d(the)h(actual)g(pack)o(et)f(size.)48 b(Since)28
b(this)g(will)h(create)e(problems)g(for)g(de)n(vices)g(which)g(are)h(e)
o(xpecting)e(a)i(full-sized)f(pack)o(et)g(or)g(attempting)g(checksum)
-364 1538 y(calculations,)c(tcpreplay)e(allo)n(ws)j(you)e(to)h(either)g
(pad)f(the)i(pack)o(et)e(with)h(zeros)g(or)g(reset)g(the)g(pack)o(et)g
(length)f(in)h(the)g(headers)g(to)g(the)g(actual)g(pack)o(et)f(size.)35
b(In)-364 1638 y(either)20 b(case,)g(the)h(IP)f(and)g(TCP)-9
b(,)20 b(UDP)h(or)f(ICMP)h(checksums)e(are)h(recalculated.)k(Examples:)
-239 1851 y Fg(\017)41 b Fl(P)o(ad)20 b(truncated)e(pack)o(ets:)-156
1950 y Fd(tcpr)m(eplay)h(-i)i(eth0)e(-u)h(pad)f(sample)o(.pcap)-239
2111 y Fg(\017)41 b Fl(Re)n(write)20 b(pack)o(et)g(header)f(lengths)h
(to)g(the)g(actual)g(pack)o(et)g(size:)-156 2210 y Fd(tcpr)m(eplay)f
(-i)i(eth0)e(-u)h(trunc)g(sample)o(.pcap)-364 2490 y
Fj(5.4)99 b(Rewriting)25 b(Lay)o(er)h(2)f(with)g(-2)-364
2690 y Fl(Starting)18 b(in)h(the)g(2.0.x)e(branch,)h(tcpreplay)f(can)h
(replace)g(the)h(e)o(xisting)f(layer)g(2)h(header)f(with)h(one)f(of)g
(your)g(choosing.)23 b(This)18 b(is)i(useful)e(for)g(when)h(you)e(w)o
(ant)i(to)-364 2789 y(change)h(the)h(layer)f(2)h(header)f(type)g(or)h
(add)f(a)h(header)f(for)g(pcap)h(\002les)g(without)g(one.)26
b(Each)20 b(pcap)h(\002le)g(tells)h(the)f(type)f(of)h(frame.)26
b(Currently)20 b(tcpreplay)f(kno)n(ws)-364 2889 y(ho)n(w)h(to)g(deal)g
(with)h(the)f(follo)n(wing)e(pcap\(3\))h(frame)g(types:)-239
3102 y Fg(\017)41 b Fl(DL)-8 b(T_EN10MB)-156 3201 y(Replace)20
b(e)o(xisting)f(802.3/Ethernet)e(II)j(header)-239 3362
y Fg(\017)41 b Fl(DL)-8 b(T_RA)h(W)-156 3461 y(Frame)20
b(has)g(no)g(Layer)f(2)h(header)m(,)f(so)h(we)h(can)f(add)g(one.)-239
3622 y Fg(\017)41 b Fl(DL)-8 b(T_LINUX_SLL)-156 3721
y(Frame)20 b(uses)g(the)h(Linux)e(Cook)o(ed)g(Sock)o(et)h(header)f
(which)g(is)j(most)e(commonly)e(created)h(with)i Fd(tcpdump)d(-i)j(any)
e Fl(on)h(a)h(Linux)e(system.)-364 3934 y(Tcpreplay)k(accepts)h(the)g
(ne)n(w)g(Layer)g(2)g(header)f(as)i(a)g(string)f(of)g(comma)f
(separated)g(he)o(x)h(v)n(alues)g(such)g(as:)34 b(0xf)n(f,0xac,0x00,0x)
o(01)o(,0x)o(c0)o(,0x)o(64)o(.)e(Note)24 b(that)-364
4034 y(the)c(leading)g('0x')f(is)i Fd(not)g Fl(required.)-364
4178 y(Potential)f(uses)h(for)e(this)i(are)f(to)h(add)e(a)i(layer)f(2)g
(header)f(for)g(DL)-8 b(T_RA)h(W)21 b(captures)e(or)h(add/remo)o(v)o(e)
d(ethernet)i(tags)i(or)f(QoS)g(features.)-364 4457 y
Fj(5.5)99 b(Rewriting)25 b(DL)-9 b(T_LINUX_SLL)27 b(\(Linux)f(Cook)o
(ed)f(Sock)o(et\))h(captur)n(es)-364 4657 y Fl(Tcpdump)15
b(uses)i(a)g(special)f(frame)g(type)g(to)h(store)g(captures)f(created)f
(with)i(the)g(\223-i)g(an)o(y\224)e(ar)o(gument.)22 b(This)16
b(frame)g(type)g(uses)h(a)g(custom)f(16)h(byte)f(layer)g(2)h(header)
-364 4756 y(which)22 b(tracks)g(which)g(interf)o(ace)g(captured)e(the)j
(pack)o(et)e(and)h(often)g(the)g(source)g(MA)m(C)h(address)e(of)i(the)f
(original)f(ethernet)g(frame.)31 b(Unfortunately)-5 b(,)20
b(it)j(ne)n(v)o(er)-364 4856 y(stores)j(the)f(destination)f(MA)m(C)h
(address)g(and)f(it)i(doesn')o(t)d(store)i(a)h(source)e(MA)m(C)i(when)e
(the)h(pack)o(et)f(is)i(captured)e(on)h(the)g(loopback)e(interf)o(ace.)
38 b(Normally)-5 b(,)-364 4956 y(tcpreplay)20 b(can')o(t)g(replay)h
(these)g(pcap)g(\002les)h(because)e(there)h(isn')o(t)g(enough)e
(information)g(in)j(the)f(LINUX_SLL)f(header)g(to)i(do)e(so;)j(ho)n(we)
n(v)o(er)c(tw)o(o)i(options)g(do)-364 5055 y(e)o(xist:)-260
5268 y(1.)41 b(Y)-9 b(ou)19 b(can)h(send)g(these)h(pack)o(ets)f(with)g
(-2)g(which)f(will)i(replace)f(the)g(LINUX_SLL)f(header)g(with)i(an)f
(ethernet)f(header)g(of)h(your)f(choosing.)-260 5428
y(2.)41 b(Y)-9 b(ou)26 b(can)h(specify)g(a)g(destination)f(MA)m(C)i
(via)f(-I)g(and)f(-J)i(in)f(which)g(case)g(tcpreplay)f(will)h(use)h
(the)f(stored)f(source)h(MA)m(C)g(and)g(create)g(a)g(ne)n(w)g(802.3)
-156 5528 y(Ethernet)16 b(header)-5 b(.)24 b(Note)18
b(that)g(if)g(the)g(pcap)f(contains)g(loopback)f(pack)o(ets,)i(you)f
(will)h(also)g(need)f(to)h(specify)g(-k)f(and/or)g(-K)h(to)g(specify)f
(the)h(source)f(MA)m(C)-156 5628 y(as)k(well)f(or)g(the)o(y)g(will)h
(be)f(skipped.)1908 5895 y(13)p eop end
%%Page: 14 14
TeXDict begin 14 13 bop -364 -281 a Fj(5.6)99 b(Rewriting)25
b(IP)g(Addr)n(esses)h(\(pseudo-N)n(A)-9 b(T\))-364 -75
y Fl(Pseudo-N)m(A)g(T)20 b(allo)n(ws)i(the)g(mapping)e(of)h(IP)h
(addresses)f(in)h(IPv4)f(and)g(ARP)i(pack)o(ets)e(from)g(one)g(subnet)g
(to)h(another)e(subnet)h(of)g(the)h(same)g(or)f(dif)n(ferent)f(size.)
-364 24 y(This)h(allo)n(ws)f(some)g(or)g(all)h(the)f(traf)n(\002c)g
(sent)g(to)h(appear)e(to)h(come)g(from)f(a)h(dif)n(ferent)f(IP)i
(subnet)e(then)h(it)h(actually)e(w)o(as)i(captured)e(on.)-364
174 y(The)25 b(mapping)d(is)k(done)d(through)g(a)i(user)f(speci\002ed)h
(translation)e(table)i(comprised)e(of)h(one)g(or)h(more)f(source)f(and)
h(destination)g(netw)o(ork\(s\))f(in)i(the)f(format)-364
273 y(of)d(<srcnet>/<masklen>:<dstnet>/<masklen>)16 b(deliminated)j(by)
h(a)h(comma.)26 b(Mapping)19 b(is)j(done)d(by)i(matching)e(IP)i
(addresses)f(to)h(the)g(source)f(subnet)g(and)-364 373
y(re)n(writing)f(the)h(most)h(signi\002cant)e(bits)i(with)f(the)h
(destination)e(subnet.)24 b(F)o(or)c(e)o(xample:)-364
522 y Fd(tcpr)m(eplay)f(-i)i(eth0)f(-N)g(10.100.0.0/16:172.)o(16)o(.10)
o(.0)o(/24)14 b(sample)o(.pcap)-364 672 y Fl(w)o(ould)19
b(match)f(an)o(y)h(IP)h(in)f(the)g(10.100.0.0/16)c(subnet)k(and)f(re)n
(write)h(it)h(as)g(if)g(it)f(came)g(from)g(or)g(sent)g(to)h(the)f
(172.16.10.0/24)14 b(subnet.)24 b(Ie:)h(10.100.5.88)15
b(w)o(ould)-364 772 y(become)k(172.16.10.88)d(and)j(10.100.99.45)d(w)o
(ould)k(become)e(172.16.10.45.)j(But)g(10.150.7.44)16
b(w)o(ould)j(not)h(be)g(re)n(written.)-364 921 y(F)o(or)d(an)o(y)g(gi)n
(v)o(en)f(IP)i(address,)f(the)h(translation)e(table)h(is)i(applied)d
(in)i(order)e(\(so)h(if)h(there)f(are)h(multiple)e(mappings,)g(earlier)
h(maps)h(tak)o(e)f(precedence\))e(and)i(occurs)-364 1021
y(only)j(once)f(per)h(IP)g(\(no)g(risk)g(of)g(an)g(address)g(getting)f
(re)n(written)h(a)g(second)g(time\).)-364 1308 y Fj(5.7)99
b(Adv)o(anced)26 b(pseudo-N)n(A)-9 b(T)-364 1514 y Fl(Pseudo-N)m(A)g(T)
21 b(also)i(w)o(orks)f(with)h(traf)n(\002c)f(splitting)h(\(using)f(tw)o
(o)g(interf)o(aces)g(or)h(output)e(\002les\))i(b)n(ut)g(with)f(a)h(fe)n
(w)g(important)e(dif)n(ferences.)30 b(First)24 b(you)d(ha)n(v)o(e)h
(the)-364 1613 y(option)h(of)h(specifying)e(one)i(or)f(tw)o(o)i
(pseudo-N)m(A)-9 b(T)22 b(tables.)36 b(Using)24 b(a)h(single)f
(pseudo-N)m(A)-9 b(T)22 b(table)i(means)f(that)h(the)h(source)e(and)g
(destination)g(IP)i(addresses)-364 1713 y(of)e(both)g(interf)o(aces)g
(are)g(re)n(written)g(using)g(the)g(same)h(rules.)35
b(Using)23 b(tw)o(o)h(pseudo-N)m(A)-9 b(T)21 b(tables)j(\(specifying)e
(-N)h(<T)-7 b(able1>)23 b(-N)g(<T)-7 b(able2>\))23 b(will)h(cause)f
(the)-364 1812 y(source)d(and)f(destination)g(IP)i(addresses)f(to)g(be)
g(re)n(written)g(dif)n(ferently)e(for)h(each)h(interf)o(ace)g(using)f
(the)h(follo)n(wing)f(matrix:)p 908 1975 2084 4 v 906
2074 4 100 v 1253 2074 V 1304 2045 a(Out)i(Primary)e(Interf)o(ace)p
2080 2074 V 98 w(Out)h(Secondary)e(Interf)o(ace)p 2990
2074 V 908 2078 2084 4 v 908 2094 V 906 2194 4 100 v
979 2164 a(Src)i(IP)p 1253 2194 V 362 w(T)-7 b(able)20
b(1)p 2080 2194 V 624 w(T)-7 b(able)20 b(2)p 2990 2194
V 908 2197 2084 4 v 906 2297 4 100 v 958 2267 a(Dest)h(IP)p
1253 2297 V 341 w(T)-7 b(able)20 b(2)p 2080 2297 V 624
w(T)-7 b(able)20 b(1)p 2990 2297 V 908 2300 2084 4 v
-364 2498 a(While)25 b(seemingly)d(a)j(bit)f(confusing,)e(this)j
(feature)d(pro)o(vides)g(a)j(number)d(of)h(interesting)g(possibilities)
h(such)g(as)h(the)f(ability)f(to)h(re)n(write)g(the)f(IP)i(headers)e
(of)-364 2597 y(pack)o(ets)h(in)f(the)h(case)g(where)f(traf)n(\002c)g
(is)i(captured)d(on)h(the)h(loopback)d(interf)o(ace)i(\(and)f(the)i
(source)f(and)g(destination)f(address)i(is)g(al)o(w)o(ays)g
(127.0.0.1\))c(so)k(that)-364 2697 y(tcpreplay)16 b(can)g(mak)o(e)h(it)
g(look)f(lik)o(e)h(tw)o(o)g(dif)n(ferent)e(systems)j(are)e(talking)g
(to)h(each)g(other)f(\(you')o(ll)f(probably)g(also)i(need)f(to)h
(specify)f(the)h(source)f(and)g(destination)-364 2797
y(MA)m(C)21 b(addresses)f(via)g(-I,)g(-J,)g(-k)g(and)g(-K\).)-364
3084 y Fj(5.8)99 b(IP)25 b(Endpoints)-364 3290 y Fl(While)j(pseudo-N)m
(A)-9 b(T)25 b(pro)o(vides)g(a)j(great)e(deal)h(of)g(\003e)o(xibility)
-5 b(,)27 b(it)h(is)g(often)e(more)h(complicated)e(then)i(is)h
(necessary)e(for)g(testing)h(of)g(inline)g(de)n(vices.)45
b(As)28 b(a)-364 3389 y(simplier)20 b(alternati)n(v)o(e,)f(tcpreplay)f
(supports)i(the)g(concept)f(of)h(re)n(writing)f(all)h(traf)n(\002c)g
(to)h(so)f(that)h(it)f(appears)g(to)g(be)g(between)g(tw)o(o)g(IP)h
(addresses:)-364 3539 y Fd(tcpr)m(eplay)e(-i)i(eth0)f(-j)g(eth1)g(-c)g
(sample)o(.cac)o(he)e(-e)i(10.0.0.1:10.1.1.1)14 b(sample)o(.pcap)-364
3688 y Fl(W)m(ill)21 b(re)n(write)f(all)h(the)f(traf)n(\002c)g(so)h
(that)f(it)h(is)g(between)e(10.0.0.1)f(and)h(10.1.1.1.)k(The)d(equi)n
(v)n(alent)e(command)g(using)i(-N)g(w)o(ould)g(be:)-364
3838 y Fd(tcpr)m(eplay)f(-i)i(eth0)f(-j)g(eth1)g(-c)g(sample)o(.cac)o
(he)e(-N)j(0.0.0.0/0:10.0.0.1)14 b(-N)21 b(0.0.0.0/0:10.1.1.)o(1)15
b(sample)o(.pcap)-364 4125 y Fj(5.9)99 b(Unifying)25
b(Dual-Outputs)-364 4330 y Fl(Since)h(a)f(number)f(of)h(tcpreplay')-5
b(s)24 b(pack)o(et)h(editing)g(functions)f(require)g(splitting)h(traf)n
(\002c)g(between)g(client)g(and)g(serv)o(ers,)h(one)f(problem)f(that)h
(may)g(arrise)g(is)-364 4430 y(needing)h(to)h(edit)g(pack)o(ets)g(b)n
(ut)g(still)h(output)e(to)h(a)g(single)g(interf)o(ace)f(or)h(\002le.)46
b(The)27 b(solution)f(to)h(this)h(is)g(to)f(use)g(the)g(one)g(output)f
(option)f(-O)j(which)e(causes)-364 4530 y(pack)o(ets)e(to)h(be)f
(processed)g(as)h(if)f(the)o(y)g(will)h(be)f(split)h(between)f(the)g
(interf)o(aces/\002les,)i(b)n(ut)e(then)g(al)o(w)o(ays)h(go)f(out)g
(the)g(primary)f(interf)o(ace)h(or)g(\002le.)38 b(Note)24
b(that)-364 4629 y(e)n(v)o(en)19 b(though)g(only)g(one)h(interf)o
(ace/\002le)f(will)i(be)f(written)g(to,)g(both)g(-i)g(and)g(-j)g(must)h
(be)f(speci\002ed;)g(although)e(the)o(y)i(can)g(be)g(the)g(same)g
(physical)f(interf)o(ace.)-364 4779 y Fd(tcpr)m(eplay)g(-i)i(eth0)f(-j)
g(eth0)g(-O)g(-c)g(sample)o(.cac)o(he)e(-e)j(10.0.0.1:10.1.1.)o(1)15
b(sample)o(.pcap)-364 4928 y Fl(Mer)o(ging)j(the)j(output)e(to)h(a)h
(single)f(\002le:)-364 5078 y Fd(tcpr)m(eplay)f(-i)i(eth0)f(-j)g(eth0)g
(-w)h(r)m(e)o(write)o(.pcap)e(-c)h(sample)o(.cac)o(he)e(-e)i
(10.0.0.1:10.1.1.1)14 b(sample)o(.pcap)1908 5895 y Fl(14)p
eop end
%%Page: 15 15
TeXDict begin 15 14 bop -364 -281 a Fk(6)120 b(Tcppr)n(ep)31
b(Usage)-364 -29 y Fj(6.1)99 b(What)25 b(is)g(tcppr)n(ep?)-364
177 y Fl(Tcpreplay)j(can)h(send)g(traf)n(\002c)g(out)g(tw)o(o)h(netw)o
(ork)e(cards,)j(ho)n(we)n(v)o(er)d(it)i(requires)e(the)i(calculations)e
(be)i(done)e(in)i(real-time.)51 b(These)30 b(calculations)e(can)h(be)
-364 276 y(e)o(xpensi)n(v)o(e)18 b(and)i(can)g(signi\002cantly)f
(reduce)g(the)i(throughput)c(of)j(tcpreplay)-5 b(.)-364
426 y(Tcpprep)18 b(is)i(a)g(libpcap)f(pre-processor)e(for)h(tcpreplay)g
(which)h(enables)g(using)g(tw)o(o)h(netw)o(ork)e(cards)i(to)f(send)h
(traf)n(\002c)f(without)g(the)g(performance)e(hit)i(of)h(doing)-364
525 y(the)g(calculations)g(in)g(real-time.)-364 813 y
Fj(6.2)99 b(Ho)o(w)25 b(does)g(tcppr)n(ep)i(w)o(ork?)-364
1018 y Fl(Tcpprep)17 b(reads)h(in)g(a)h(libpcap)e(\(tcpdump\))f
(formatted)g(capture)h(\002le)i(and)f(does)g(some)g(processing)f(to)h
(generate)f(a)i(tcpreplay)e(cache)g(\002le.)25 b(This)19
b(cache)e(\002le)i(tells)-364 1118 y(tcpreplay)g(which)h(interf)o(ace)f
(a)i(gi)n(v)o(en)d(pack)o(et)i(should)f(be)h(sent)h(out)f(of.)-364
1405 y Fj(6.3)99 b(Does)25 b(tcppr)n(ep)i(modify)e(my)g(libpcap)g
(\002le?)-364 1611 y Fl(No.)-364 1898 y Fj(6.4)99 b(Wh)o(y)25
b(use)g(tcppr)n(ep?)-364 2104 y Fl(There)20 b(are)g(three)f(major)h
(reasons)g(to)g(use)g(tcpprep:)-260 2336 y(1.)41 b(Tcpprep)18
b(can)i(split)h(traf)n(\002c)f(based)g(upon)e(more)i(methods)f(and)h
(criteria)f(then)h(tcpreplay)-5 b(.)-260 2502 y(2.)41
b(By)20 b(pre-processing)e(the)i(pcap,)f(tcpreplay)g(has)h(a)h(higher)e
(theoretical)g(maximum)g(throughput.)-260 2668 y(3.)41
b(By)20 b(pre-processing)e(the)i(pcap,)f(tcpreplay)g(can)h(be)g(more)g
(accurate)f(in)h(timing)g(when)f(replaying)g(traf)n(\002c)h(at)g
(normal)f(speed.)-364 2956 y Fj(6.5)99 b(Can)25 b(a)g(cache)h(\002le)f
(be)h(used)f(f)n(or)g(multiple)g(\(differ)n(ent\))i(libpcap)f(\002les?)
-364 3161 y Fl(Cache)f(\002les)g(ha)n(v)o(e)e(nothing)g(linking)g(them)
h(to)g(a)h(gi)n(v)o(en)e(libpcap)g(\002le,)j(so)f(there)e(is)j(nothing)
c(to)j(stop)f(you)f(from)g(doing)g(this.)38 b(Ho)n(we)n(v)o(er)23
b(running)f(tcpreplay)-364 3261 y(with)f(a)f(cache)g(\002le)h(from)e(a)
i(dif)n(ferent)d(libpcap)h(source)h(\002le)h(is)g(lik)o(ely)f(to)g
(cause)g(a)h(lot)f(of)g(problems)f(and)h(is)h(not)f(supported.)-364
3548 y Fj(6.6)99 b(Wh)o(y)25 b(w)o(ould)g(I)f(want)i(to)f(use)g(tcpr)n
(eplay)h(with)f(tw)o(o)g(netw)o(ork)h(cards?)-364 3754
y Fl(Tcpreplay)j(traditionally)h(is)h(good)f(for)g(putting)g(traf)n
(\002c)h(on)f(a)h(gi)n(v)o(en)f(netw)o(ork,)i(often)e(used)h(to)g(test)
g(a)h(netw)o(ork)d(intrusion)h(detection)g(system)h(\(NIDS\).)-364
3854 y(Ho)n(we)n(v)o(er)m(,)17 b(there)i(are)f(cases)i(where)e(putting)
g(traf)n(\002c)h(onto)f(a)h(subnet)f(in)h(this)h(manner)d(is)j(not)e
(good)g(enough-)e(you)i(ha)n(v)o(e)h(to)g(be)f(able)h(to)g(send)g(traf)
n(\002c)f(*through*)-364 3953 y(a)j(de)n(vice)e(such)h(as)h(a)g(router)
m(,)d(\002re)n(w)o(all,)i(or)g(bridge.)-364 4103 y(In)g(these)g(cases,)
h(being)e(able)h(to)h(use)f(a)h(single)f(source)f(\002le)i(\(libpcap\))
e(for)g(both)h(ends)g(of)f(the)i(connection)d(solv)o(es)i(this)h
(problem.)-364 4390 y Fj(6.7)99 b(Ho)o(w)25 b(big)f(ar)n(e)i(the)f
(cache)h(\002les?)-364 4596 y Fl(V)-9 b(ery)24 b(small.)39
b(Actual)25 b(size)g(depends)e(on)i(the)f(number)f(of)i(pack)o(ets)f
(in)h(the)g(dump)e(\002le.)39 b(T)-7 b(w)o(o)25 b(bits)g(of)g(data)f
(is)i(stored)e(for)g(each)g(pack)o(et.)38 b(On)25 b(a)g(test)h(using)e
(a)-364 4695 y(900MB)c(dump)f(\002le)h(containing)f(o)o(v)o(er)f
(500,000)g(pack)o(ets,)i(the)g(cache)g(\002le)h(w)o(as)g(only)e(150K.)
-364 4983 y Fj(6.8)99 b(What)25 b(ar)n(e)h(these)f('modes')h(tcppr)n
(ep)h(has?)-364 5188 y Fl(Tcpprep)19 b(has)h(three)g(basic)g(modes)g
(which)f(require)g(the)h(user)g(to)h(specify)e(ho)n(w)h(to)g(split)h
(traf)n(\002c.)-239 5421 y Fg(\017)41 b Fl(CIDR)20 b(\(-c\))f(mode)f
(requires)h(the)g(user)h(to)f(pro)o(vide)f(a)i(list)g(of)f(netw)o
(orks.)24 b(An)o(y)19 b(pack)o(et)g(with)g(a)h(source)f(IP)h(in)f(one)g
(of)g(these)h(netw)o(orks)f(gets)g(sent)h(out)f(the)-156
5520 y(primary)f(interf)o(ace.)1908 5895 y(15)p eop end
%%Page: 16 16
TeXDict begin 16 15 bop -239 -281 a Fg(\017)41 b Fl(Re)o(ge)o(x)22
b(\(-r\))g(mode)f(requires)h(the)h(user)f(to)h(pro)o(vide)e(a)i(re)o
(gular)e(e)o(xpression.)31 b(An)o(y)22 b(pack)o(et)g(with)h(a)h(source)
d(IP)j(matching)d(the)i(re)o(ge)o(x)e(gets)i(sent)g(out)f(the)-156
-181 y(primary)c(interf)o(ace.)-239 -17 y Fg(\017)41
b Fl(Port)25 b(\(-p\))g(mode)f(splits)j(TCP/UDP)f(traf)n(\002c)g(based)
f(on)g(the)h(destination)e(port)h(in)h(the)f(header)-5
b(.)41 b(Normally)-5 b(,)25 b(ports)g(0-1023)e(are)j(considered)d
(\223serv)o(er\224)-156 82 y(ports)k(and)f(e)n(v)o(erything)f(else)i(a)
h(client)f(port.)45 b(Y)-9 b(ou)27 b(can)f(create)h(your)f(o)n(wn)h
(custom)f(mapping)g(\002le)h(in)h(the)f(same)g(format)f(as)i
(/etc/services)f(\(see)g(the)-156 182 y(services\(5\))19
b(man)g(page)h(for)g(details\))g(by)f(specifying)g(-s)i(<\002le>.)-364
407 y(And)d(four)g(auto)g(modes)g(in)g(which)g(tcpprep)f(decides)h(ho)n
(w)g(to)h(split)g(traf)n(\002c.)24 b(Auto)18 b(modes)g(are)h(useful)f
(for)g(when)f(you)h(don')o(t)f(kno)n(w)g(much)h(about)g(the)g(contents)
-364 507 y(of)i(the)g(dump)f(\002le)i(in)f(question)g(and)f(you)g(w)o
(ant)i(to)f(split)h(traf)n(\002c)f(up)g(based)f(upon)g(serv)o(ers)h
(and)f(clients.)-239 732 y Fg(\017)41 b Fl(Auto/Router)19
b(\(-a)h(-n)h(router\))e(mode)h(trys)g(to)h(\002nd)g(the)f(lar)o(gest)g
(netw)o(ork\(s\))f(that)i(contain)f(all)h(the)f(serv)o(ers)h(and)f(no)g
(clients.)27 b(An)o(y)19 b(unkno)n(wn)g(system)h(is)-156
831 y(automatically)e(re-classi\002ed)i(as)h(serv)o(ers)f(if)g(it')-5
b(s)22 b(inside)e(the)g(serv)o(er)f(netw)o(ork\(s\),)g(otherwise)g(it)i
(is)g(classi\002ed)g(as)g(a)g(client.)-239 995 y Fg(\017)41
b Fl(Auto/Bridge)18 b(\(-a)i(-n)f(bridge\))f(mode)h(mak)o(es)h(the)g
(assumption)e(that)i(the)g(clients)g(and)g(serv)o(ers)f(are)h(horribly)
d(intermix)o(ed)h(on)i(the)g(netw)o(ork)e(and)h(there')-5
b(s)-156 1095 y(no)20 b(w)o(ay)g(to)g(subnet)g(them.)k(While)d(this)g
(tak)o(es)f(less)h(processing)e(time)i(to)f(create)g(the)g(cache)g
(\002le)h(it)g(is)g(unable)e(to)h(deal)g(with)h(unkno)n(wn)c(systems.)
-239 1259 y Fg(\017)41 b Fl(Auto/Client)24 b(\(-a)h(-n)f(client\))h
(mode)f(which)g(w)o(orks)g(just)i(lik)o(e)f(Auto/Bridge)e(mode,)i(e)o
(xcept)f(that)h(an)o(y)f(system)h(it)g(can')o(t)f(\002gure)g(out)h(is)h
(treated)e(lik)o(e)h(a)-156 1359 y(client.)-239 1523
y Fg(\017)41 b Fl(Auto/Serv)o(er)21 b(\(-a)j(-n)f(serv)o(er\))f(mode)h
(which)g(w)o(orks)g(just)h(lik)o(e)f(Auto/Bridge)g(mode,)g(e)o(xcept)f
(that)i(an)o(y)e(system)i(it)g(can')o(t)f(\002gure)g(out)g(is)h
(treated)f(lik)o(e)h(a)-156 1622 y(serv)o(er)-5 b(.)-364
1907 y Fj(6.9)99 b(Splitting)26 b(traf\002c)g(based)f(upon)h(IP)f(addr)
n(ess)-364 2110 y Fl(Tcpprep)g(supports)h(the)g(same)h(CIDR)h(mode)e
(that)g(tcpreplay)g(supports)f(using)h(the)h(-c)g(\003ag)g(\(tcpreplay)
d(uses)k(-C\).)e(Additionally)-5 b(,)26 b(tcpprep)f(also)i(supports)
-364 2210 y(re)o(ge)o(x\(7\))18 b(re)o(gular)g(e)o(xpressions)h(to)i
(match)e(source)h(IP)g(addresses)g(using)g(the)g(-r)g(\003ag.)-364
2494 y Fj(6.10)99 b(A)-5 b(uto)25 b(Mode)-364 2697 y
Fi(6.10.1)81 b(Ho)o(w)20 b(does)g(A)l(uto/Bridge)g(mode)h(w)o(ork?)-364
2901 y Fl(Tcpprep)h(does)h(an)g(initial)h(pass)g(o)o(v)o(er)e(the)h
(libpcap)g(\002le)h(to)f(b)n(uild)g(a)h(binary)e(tree)i(\(one)e(node)h
(per)g(IP\).)g(F)o(or)g(each)g(IP)-9 b(,)23 b(it)h(k)o(eeps)g(track)f
(of)g(ho)n(w)g(man)o(y)f(times)i(it)-364 3000 y(w)o(as)c(a)f(client)g
(or)g(serv)o(er)-5 b(.)24 b(It)19 b(then)g(does)g(a)g(second)f(pass)i
(of)e(the)h(\002le)h(using)e(the)h(data)g(in)g(the)g(tree)g(and)g(the)g
(ratio)f(to)h(determine)f(if)h(an)g(IP)g(is)h(a)g(client)f(or)f(serv)o
(er)-5 b(.)24 b(If)-364 3100 y(tcpprep)19 b(is)i(unable)f(to)g
(determine)f(the)h(type)g(\(client)g(or)g(serv)o(er\))f(for)h(each)g
(and)g(e)n(v)o(ery)f(pack)o(et,)g(then)h(auto/bridge)e(mode)i(will)h(f)
o(ail.)k(In)20 b(these)h(cases,)g(it)g(is)g(best)-364
3200 y(to)g(use)f(a)h(dif)n(ferent)d(auto)i(mode.)-364
3467 y Fi(6.10.2)81 b(Ho)o(w)20 b(does)g(A)l(uto/Router)f(mode)i(w)o
(ork?)-364 3671 y Fl(Tcpprep)g(does)g(the)h(same)h(\002rst)g(pass)f(as)
h(Auto/Bridge)e(mode.)30 b(It)22 b(then)g(trys)g(to)g(con)m(v)o(ert)e
(the)i(binary)f(tree)h(into)g(a)h(list)g(of)f(netw)o(orks)f(containing)
f(the)i(serv)o(ers.)-364 3770 y(Finally)j(it)h(uses)f(the)g(CIDR)h
(mode)e(with)i(the)f(list)h(of)f(serv)o(er)f(netw)o(orks)g(in)h(a)g
(second)g(pass)g(of)g(the)g(libpcap)f(\002le.)40 b(Unlik)o(e)25
b(auto/bridge)d(mode,)j(auto/router)-364 3870 y(mode)19
b(can)h(al)o(w)o(ays)h(successfully)f(split)g(IP)h(addresses)f(into)g
(clients)g(and)g(serv)o(ers.)-364 4138 y Fi(6.10.3)81
b(Determining)20 b(Clients)h(and)f(Ser)o(v)o(ers)-364
4341 y Fl(Tcpprep)f(uses)h(the)h(follo)n(wing)d(methods)h(in)i
(auto/router)d(and)h(auto/bridge)f(mode)h(to)i(determine)d(if)j(an)f
(IP)h(address)e(is)j(a)e(client)g(or)g(serv)o(er:)-239
4566 y Fg(\017)41 b Fl(Client:)-57 4746 y Fi(\226)g Fl(TCP)21
b(with)g(Syn)f(\003ag)g(set)-57 4877 y Fi(\226)41 b Fl(UDP)21
b(source/destination)d(port)i(53)f(\(DNS\))h(without)g(query)f(\003ag)h
(set)-57 5007 y Fi(\226)41 b Fl(ICMP)21 b(port)f(unreachable)d
(\(destination)i(IP)i(of)f(pack)o(et\))-239 5187 y Fg(\017)41
b Fl(Serv)o(er:)-57 5366 y Fi(\226)g Fl(TCP)21 b(with)g(Syn/Ack)e
(\003ag)h(set)-57 5497 y Fi(\226)41 b Fl(UDP)21 b(source/destination)d
(port)i(53)f(\(DNS\))h(with)h(query)e(\003ag)h(set)-57
5628 y Fi(\226)41 b Fl(ICMP)21 b(port)f(unreachable)d(\(source)j(IP)g
(of)g(pack)o(et\))1908 5895 y(16)p eop end
%%Page: 17 17
TeXDict begin 17 16 bop -364 -281 a Fi(6.10.4)81 b(Client/Ser)o(v)o(er)
20 b(ratio)-364 -75 y Fl(Since)g(a)f(system)h(may)f(send)g(traf)n
(\002c)g(which)f(w)o(ould)h(classify)h(it)g(as)g(both)e(a)i(client)f
(and)g(serv)o(er)m(,)f(it')-5 b(s)20 b(necessary)f(to)g(be)h(able)f(to)
g(weigh)g(the)g(traf)n(\002c.)25 b(This)19 b(is)h(done)-364
24 y(by)g(specifying)e(the)i(client/serv)o(er)f(ratio)g(\(-R\))h(which)
g(is)g(by)g(def)o(ault)f(set)i(to)f(2.0.)k(The)c(ratio)f(is)i(the)f
(modi\002er)f(to)h(the)g(number)e(of)i(client)g(connections.)j(Hence,)
-364 124 y(by)d(def)o(ault,)f(client)h(connections)f(are)h(v)n(alued)f
(twice)i(as)f(high)g(as)h(serv)o(er)e(connections.)-364
411 y Fj(6.11)99 b(Selecti)o(v)o(ely)25 b(sending/dr)n(opping)i(pack)o
(ets)-364 617 y Fl(Tcpprep)19 b(supports)g(the)h(same)g(-x)g(and)g(-X)g
(options)f(to)i(selecti)n(v)o(ely)e(send)h(or)g(drop)f(pack)o(ets.)-364
904 y Fj(6.12)99 b(Using)25 b(tcppr)n(ep)i(cache)f(\002les)f(with)g
(tcpr)n(eplay)-364 1110 y Fl(Just)c(run:)-364 1259 y
Fd(tcpr)m(eplay)e(-c)i(sample)o(.cac)o(he)d(-i)i(eth0)g(-j)g(eth1)g
(sample)o(.pcap)-364 1547 y Fj(6.13)99 b(Commenting)26
b(tcppr)n(ep)h(cache)e(\002les)-364 1752 y Fl(In)j(v)o(ersions)e(of)i
(tcpprep)e(>=)i(2.1.0,)g(you)e(can)i(specify)f(a)h(comment)e(to)i(be)g
(embeded)d(in)j(the)g(tcpprep)e(cache)h(\002le.)48 b(Comments)27
b(are)h(user)g(speci\002ed)f(and)-364 1852 y(automatically)19
b(include)g(the)h(command)f(line)h(ar)o(guments)e(passed)i(to)g
(tcpprep.)-364 2001 y Fd(tcppr)m(ep)g(-C)g(\223this)h(is)g(my)g
(comment\224)e(-i)i(sample)o(.pcap)d(-o)i(sample)o(.cac)o(he)e(<other)i
(ar)m(gs>)-364 2151 y Fl(Or)h(for)e(no)h(user)g(comment,)e(b)n(ut)j
(still)g(embed)e(the)h(command)f(ar)o(guments:)-364 2300
y Fd(tcppr)m(ep)h(-C)g(\223\224)h(-i)g(sample)o(.pcap)d(-o)i(sample)o
(.cac)o(he)d(<other)k(ar)m(gs>)-364 2450 y Fl(Y)-9 b(ou)20
b(can)g(then)g(later)g(on)g(print)f(out)h(the)g(comments)f(by)h
(running:)-364 2599 y Fd(tcppr)m(ep)g(-P)g(sample)o(.cac)o(he)-364
2929 y Fk(7)120 b(Flo)o(wr)n(eplay)30 b(Usage)-364 3164
y Fl(While)22 b(tcpreplay)e(is)i(a)f(great)g(w)o(ay)g(to)h(test)g(NIDS)
f(and)g(\002re)n(w)o(alls,)h(it)g(can')o(t)e(be)h(used)g(to)g(test)h
(serv)o(ers)f(or)g(HIDS)g(since)h(tcpreplay)d(can')o(t)i(connect)f(to)h
(a)h(service)-364 3264 y(running)d(on)h(a)g(de)n(vice.)25
b(The)20 b(solution)g(to)h(this)g(problem)d(is)k(\003o)n(wreplay)d
(which)h(instead)g(of)g(sending)f(pack)o(ets)i(at)f(Layer)g(2)h
(\(ethernet)e(header)g(and)h(up\),)f(it)j(can)-364 3364
y(actually)e(connect)f(via)i(TCP)g(or)f(UDP)h(to)g(serv)o(er)e(and)h
(then)g(sends)g(and)g(recei)n(v)o(es)g(data)g(based)g(upon)f(a)i(pcap)f
(capture)f(\002le)i(created)f(with)g(a)h(tool)f(lik)o(e)h(Ethereal)-364
3463 y(or)f(tcpdump.)-364 3613 y(Please)h(note)f(that)g(\003o)n
(wreplay)f(is)i(currently)d(alpha)i(quality)f(and)h(is)h(missing)f(a)h
(number)d(of)i(k)o(e)o(y)g(features.)-364 3900 y Fj(7.1)99
b(Ho)o(w)25 b(\003o)o(wr)n(eplay)g(w)o(orks)-364 4106
y Fl(Put)j(simply)-5 b(,)28 b(\003o)n(wreplay)e(opens)g(a)i(sock)o(et)f
(connection)e(to)i(a)h(service)f(on)g(a)g(tar)o(get)g(system\(s\))g
(and)f(sends)i(data)f(o)o(v)o(er)f(that)h(sock)o(et)g(based)g(on)g(the)
g(pack)o(et)-364 4205 y(capture.)g(Flo)n(wreplay)20 b(has)i(no)f
(understanding)d(of)j(the)g(application)f(protocol)f(\(lik)o(e)j(HTTP)f
(or)g(FTP\))g(so)h(it)g(is)g(some)n(what)f(limited)g(in)g(ho)n(w)g(it)h
(can)f(deal)g(with)-364 4305 y(complicated)e(e)o(xchanges)f(between)h
(client)i(and)e(serv)o(er)-5 b(.)-364 4454 y(Some)20
b(of)g(these)g(limitations)g(are:)-239 4687 y Fg(\017)41
b Fl(Flo)n(wreplay)19 b(only)g(plays)h(the)g(client)g(side)1066
4657 y Ff(10)1149 4687 y Fl(of)g(the)g(connection.)-239
4853 y Fg(\017)41 b Fl(Flo)n(wreplay)22 b(doesn')o(t)g(understand)f
(the)i(application)f(protocols.)33 b(Hence)23 b(it)i(can')o(t)d(al)o(w)
o(ays)i(deal)f(with)h(the)f(case)h(when)f(the)g(serv)o(er)g(sends)g(a)h
(dif)n(ferent)-156 4953 y(response)19 b(then)h(what)g(w)o(as)h
(originally)e(captured)f(in)i(the)h(pcap)e(\002le.)-239
5119 y Fg(\017)41 b Fl(Flo)n(wreplay)19 b(only)g(sends)h(TCP)h(and)f
(UDP)h(traf)n(\002c.)-239 5285 y Fg(\017)41 b Fl(Flo)n(wreplay)19
b(doesn')o(t)f(kno)n(w)h(about)h(multi-\003o)n(w)f(protocols)g(lik)o(e)
h(FTP)-9 b(.)-239 5451 y Fg(\017)41 b Fl(Flo)n(wreplay)19
b(can')o(t)g(listen)h(on)g(a)h(port)e(and)h(w)o(ait)h(for)e(a)i(client)
f(to)h(connect)e(to)h(it.)p -364 5522 1851 4 v -298 5577
a Fc(10)-244 5601 y Fb(Flo)n(wreplay)f(assumes)e(the)h(\002rst)f(UDP)f
(pack)o(et)k(on)d(a)g(gi)n(v)o(en)h(4-tuple)h(is)e(the)h(client)1908
5895 y Fl(17)p eop end
%%Page: 18 18
TeXDict begin 18 17 bop -364 -281 a Fj(7.2)99 b(Running)26
b(\003o)o(wr)n(eplay)-364 -75 y Fl(See)21 b(the)f(\003o)n(wreplay\(8\))
e(man)h(page)h(for)f(details.)-364 255 y Fk(8)120 b(T)-11
b(uning)31 b(OS')l(s)e(f)m(or)g(high)i(perf)m(ormance)-364
490 y Fl(Re)o(gardless)20 b(of)h(the)g(size)h(of)e(physical)g(memory)-5
b(,)19 b(UNIX)i(k)o(ernels)f(will)i(only)e(allocate)h(a)g(static)h
(amount)e(for)g(netw)o(ork)g(b)n(uf)n(fers.)26 b(This)21
b(includes)f(pack)o(ets)h(sent)-364 590 y(via)d(the)g("ra)o(w")f
(interf)o(ace,)g(lik)o(e)h(with)g(tcpreplay)-5 b(.)22
b(Most)c(k)o(ernels)f(will)h(allo)n(w)g(you)e(to)i(tweak)g(the)f(size)i
(of)e(these)h(b)n(uf)n(fers,)f(drastically)g(increasing)f(performance)
-364 689 y(and)k(accurac)o(y)-5 b(.)-364 839 y(N)r Fb(O)q(T)t(E)t
Fl(:)35 b(The)23 b(follo)n(wing)g(information)e(is)k(pro)o(vided)c
(based)i(upon)g(our)g(o)n(wn)g(e)o(xperiences)f(or)h(the)h(reported)e
(e)o(xperiences)g(of)h(others.)36 b(Depending)21 b(on)j(your)-364
938 y(hardw)o(are)c(and)h(speci\002c)h(hardw)o(are,)f(it)h(may)f(or)g
(may)h(not)f(w)o(ork)g(for)g(you.)28 b(It)22 b(may)f(e)n(v)o(en)g(mak)o
(e)g(your)f(system)i(horribly)e(unstable,)h(corrupt)f(your)g(harddri)n
(v)o(e,)-364 1038 y(or)g(w)o(orse.)-362 1187 y(N)t Fb(O)q(T)t(E)r
Fl(:)29 b(Dif)n(ferent)21 b(operating)f(systems,)j(netw)o(ork)e(card)g
(dri)n(v)o(ers,)g(and)h(e)n(v)o(en)f(hardw)o(are)f(can)i(ha)n(v)o(e)f
(an)h(ef)n(fect)g(on)f(the)h(accurac)o(y)e(of)i(pack)o(et)f(timestamps)
h(that)-364 1287 y(tcpdump)d(or)g(other)h(capture)f(utilities)i
(generate.)i(And)d(as)h(you)e(kno)n(w:)25 b(garbage)18
b(in,)i(garbage)e(out.)-362 1437 y(N)t Fb(O)q(T)t(E)t
Fl(:)28 b(If)20 b(you)f(ha)n(v)o(e)h(information)e(on)h(tuning)g(the)i
(k)o(ernel)e(of)h(an)g(operating)e(system)j(not)f(listed)g(here,)g
(please)g(send)g(it)h(to)f(me)g(so)h(I)f(can)g(include)f(it.)-364
1724 y Fj(8.1)99 b(Linux)26 b(2.4.x)-364 1929 y Fl(The)c(follo)n(wing)e
(is)j(kno)n(wn)e(to)h(apply)f(to)i(the)f(2.4.x)e(series)j(of)f(k)o
(ernels.)30 b(If)22 b(an)o(yone)e(has)i(an)o(y)g(information)d(re)o
(garding)g(other)j(k)o(ernel)f(v)o(ersions,)g(please)h(let)h(us)-364
2029 y(kno)n(w)-5 b(.)32 b(By)23 b(def)o(ault)f(Linux')-5
b(s)22 b(tcpreplay)g(performance)e(isn')o(t)i(all)i(that)f(stellar)-5
b(.)33 b(Ho)n(we)n(v)o(er)m(,)22 b(with)h(a)g(simple)g(tweak,)g(relati)
n(v)o(ely)f(decent)g(performance)e(can)i(be)-364 2129
y(had)c(on)g(the)h(right)e(hardw)o(are.)23 b(By)c(def)o(ault,)f(Linux)f
(speci\002es)i(a)g(64K)f(b)n(uf)n(fer)f(for)h(sending)f(pack)o(ets.)25
b(Increasing)16 b(this)j(b)n(uf)n(fer)e(to)i(about)e(half)i(a)f(me)o
(gabyte)f(does)-364 2228 y(a)k(good)e(job:)-364 2378
y Fd(ec)o(ho)g(524287)f(>/pr)l(oc/sys/net/cor)m(e/wmem_default)-364
2477 y(ec)o(ho)h(524287)f(>/pr)l(oc/sys/net/cor)m(e/wmem_max)-364
2577 y(ec)o(ho)h(524287)f(>/pr)l(oc/sys/net/cor)m(e/rmem_max)-364
2677 y(ec)o(ho)h(524287)f(>/pr)l(oc/sys/net/cor)m(e/rmem_default)-364
2826 y Fl(On)j(one)f(system,)h(we')l(v)o(e)e(seen)i(a)g(jump)f(from)f
(23.02)g(me)o(gabits/sec)h(\(5560)f(pack)o(ets/sec\))h(to)g(220.30)f
(me)o(gabits/sec)g(\(53212)g(pack)o(ets/sec\))h(which)g(is)h(nearly)
-364 2926 y(a)g(10x)e(increase)h(in)g(performance.)i(Depending)c(on)i
(your)f(system)h(and)g(capture)f(\002le,)i(dif)n(ferent)d(numbers)h
(may)h(pro)o(vide)e(dif)n(ferent)g(results.)-364 3213
y Fj(8.2)99 b(*BSD)-364 3419 y Fl(*BSD)21 b(systems)f(typically)f(allo)
n(w)h(you)f(to)h(specify)g(the)g(size)g(of)g(netw)o(ork)f(b)n(uf)n
(fers)f(with)j(the)e(NMBCLUSTERS)i(option)e(in)h(the)g(k)o(ernel)f
(con\002g)g(\002le.)26 b(Experi-)-364 3518 y(ment)20
b(with)g(dif)n(ferent)f(sizes)i(to)f(see)h(which)f(yields)g(the)g(best)
h(performance.)h(See)e(the)g(options\(4\))f(man)g(page)h(for)f(more)h
(details.)-364 3848 y Fk(9)120 b(Understanding)31 b(Common)f(Err)n(or)f
(and)i(W)-8 b(ar)n(ning)31 b(Messages)-364 4100 y Fj(9.1)99
b(Can't)26 b(open)g(eth0:)31 b(libnet_select_de)o(vice\(\):)h(Can't)26
b(\002nd)g(interface)g(eth0)-364 4306 y Fl(Generally)19
b(this)i(occurs)e(when)h(the)g(interf)o(ace)g(\(eth0)f(in)h(this)h(e)o
(xample\))d(is)k(not)d(up)h(or)g(doesn')o(t)f(ha)n(v)o(e)g(an)i(IP)f
(address)g(assigned)g(to)g(it.)-364 4593 y Fj(9.2)99
b(Can't)26 b(open)g(lo:)k(libnet_select_de)o(vice\(\):)i(Can't)26
b(\002nd)g(interface)g(lo)-364 4799 y Fl(V)-9 b(ersion)18
b(1.1.0)f(of)h(Libnet)f(is)j(unable)d(to)h(send)g(traf)n(\002c)g(on)g
(the)h(loopback)d(de)n(vice.)23 b(Upgrade)17 b(to)h(a)h(later)g
(release)f(of)g(the)g(Libnet)g(library)f(to)i(solv)o(e)e(this)i
(problem.)-364 5086 y Fj(9.3)99 b(Can't)26 b(open)g(eth0:)31
b(UID)25 b(!=)g(0)-364 5292 y Fl(Tcpreplay)19 b(requires)g(that)h(you)f
(run)h(it)h(as)g(root.)1908 5895 y(18)p eop end
%%Page: 19 19
TeXDict begin 19 18 bop -364 -281 a Fj(9.4)99 b(100000)24
b(write)h(attempts)h(failed)f(fr)n(om)g(full)g(b)n(uffers)h(and)g(wer)n
(e)g(r)n(epeated)-364 -75 y Fl(When)d(tcpreplay)f(displays)h(a)h
(message)f(lik)o(e)h("100000)c(write)k(attempts)f(f)o(ailed)g(from)f
(full)i(b)n(uf)n(fers)e(and)h(were)g(repeated",)f(this)i(usually)f
(means)g(the)g(k)o(ernel)-364 24 y(b)n(uf)n(fers)d(were)g(full)g(and)g
(it)i(had)e(to)g(w)o(ait)h(until)g(memory)d(w)o(as)k(a)n(v)n(ailable.)j
(This)c(is)g(quite)f(common)f(when)h(replaying)f(\002les)i(as)g(f)o
(ast)g(as)h(possible)e(with)g(the)h("-R")-364 124 y(option.)j(See)d
(the)f(tuning)f(OS)i(section)f(in)g(this)h(document)d(for)h
(suggestions)h(on)f(solving)h(this)g(problem.)-364 411
y Fj(9.5)99 b(In)l(v)o(alid)25 b(mac)g(addr)n(ess:)32
b(00:00:00:00:00:00)-364 617 y Fl(Currently)20 b(tcpreplay)f(reserv)o
(es)h(the)h(MA)m(C)g(address)f(of)g(00:00:00:00:00:00)c(as)21
b(reserv)o(ed)f(for)g(internal)f(use.)27 b(Hence)20 b(you)g(can')o(t)g
(re)n(write)g(the)h(MA)m(C)g(address)-364 717 y(of)29
b(pack)o(ets)f(to)h(be)f(all)h(zeros.)50 b(While)29 b(we)g(intend)f(to)
h(\002x)g(this)g(someday)e(it')-5 b(s)30 b(not)e(currently)f(high)h(on)
g(our)g(priority)f(list,)32 b(so)d(let)g(us)g(kno)n(w)e(if)i(we)g
(should)-364 816 y(re-prioritize)18 b(things.)-364 1104
y Fj(9.6)99 b(Unable)26 b(to)f(pr)n(ocess)g(test.cache:)32
b(cache)26 b(\002le)f(v)o(ersion)g(missmatch)-364 1309
y Fl(Cache)20 b(\002les)g(generated)d(by)i(tcpprep)f(and)h(read)g(by)g
(tcpreplay)e(are)j(v)o(ersioned)d(to)j(allo)n(w)f(enhancements)e(to)j
(the)f(cache)g(\002le)h(format.)j(An)o(ytime)c(the)g(cache)g(\002le)
-364 1409 y(format)h(changes,)g(the)h(v)o(ersion)e(is)j(incremented.)j
(Since)c(this)g(occurs)f(on)h(a)g(v)o(ery)f(rare)g(basis,)h(this)h(is)g
(generally)d(not)i(an)f(issue;)i(ho)n(we)n(v)o(er)d(an)o(ytime)h(there)
g(is)i(a)-364 1508 y(change,)c(it)j(breaks)d(compatibility)g(with)i
(pre)n(viously)e(created)g(cache)i(\002les.)25 b(The)19
b(solution)g(for)g(this)h(problem)e(is)i(to)g(use)g(the)g(same)f(v)o
(ersion)g(of)g(tcpreplay)f(and)-364 1608 y(tcpprep)h(to)h(read/write)g
(the)g(cache)g(\002les.)25 b(Cache)c(\002le)g(v)o(ersions)e(match)g
(the)i(follo)n(wing)d(v)o(ersions)h(of)h(tcpprep/tcpreplay:)-239
1840 y Fg(\017)41 b Fl(V)-9 b(ersion)19 b(1:)-156 1940
y(Prior)h(to)g(1.3.beta1)-239 2106 y Fg(\017)41 b Fl(V)-9
b(ersion)19 b(2:)-156 2206 y(1.3.beta2)f(to)i(1.3.1/1.4.beta1)-239
2372 y Fg(\017)41 b Fl(V)-9 b(ersion)19 b(3:)-156 2471
y(1.3.2/1.4.beta2)d(to)k(2.0.3)-239 2637 y Fg(\017)41
b Fl(V)-9 b(ersion)19 b(4:)-156 2737 y(2.1.0)f(and)g(abo)o(v)o(e.)23
b(Note)d(that)f(prior)f(to)h(v)o(ersion)f(2.3.0,)g(tcpprep)g(had)h(a)g
(b)n(ug)g(which)g(brok)o(e)f(cache)h(\002le)h(compatibility)d(between)i
(big)g(and)f(little)i(endian)-156 2837 y(systems.)-364
3124 y Fj(9.7)99 b(Skipping)26 b(SLL)h(loopback)e(pack)o(et.)-364
3330 y Fl(Y)-9 b(our)18 b(capture)f(\002le)i(w)o(as)g(created)e(on)h
(Linux)f(with)i(the)f('an)o(y')f(parameter)g(which)h(then)f(captured)g
(a)i(pack)o(et)e(on)h(the)h(loopback)d(interf)o(ace.)23
b(Ho)n(we)n(v)o(er)m(,)17 b(tcpreplay)-364 3429 y(doesn')o(t)22
b(ha)n(v)o(e)h(enough)e(information)g(to)i(actual)h(send)f(the)g(pack)o
(et,)g(so)h(it)g(skips)f(it.)35 b(Specifying)22 b(a)i(source)e(and)h
(destination)f(MA)m(C)i(address)f(\(-I,)f(-k,)i(-J,)g(-K\))-364
3529 y(will)d(allo)n(w)f(tcpreplay)f(to)h(send)g(these)h(pack)o(ets.)
-364 3816 y Fj(9.8)99 b(P)o(ack)o(et)26 b(length)g(\(8892\))e(is)g(gr)n
(eater)i(then)g(MTU;)g(skipping)f(pack)o(et.)-364 4022
y Fl(The)20 b(pack)o(et)g(length)g(\(in)g(this)h(case)g(8892)f(bytes\))
g(is)h(greater)f(then)g(the)g(maximum)f(transmition)g(unit)i(\(MTU\))f
(on)g(the)g(outgoing)f(interf)o(ace.)25 b(Tcpreplay)18
b(must)-364 4121 y(skip)k(the)f(pack)o(et.)28 b(Alternati)n(v)o(ely)-5
b(,)19 b(you)i(can)g(specify)g(the)g(-T)g(option)g(and)f(tcpreplay)g
(will)j(truncate)d(the)h(pack)o(et)g(to)h(the)f(MTU)g(size,)i(\002x)e
(the)h(checksums)e(and)-364 4221 y(send)g(it.)-364 4509
y Fj(9.9)99 b(Wh)o(y)25 b(is)f(tcpr)n(eplay)i(not)f(sending)h(all)e
(the)i(pack)o(ets?)-364 4714 y Fl(Ev)o(ery)18 b(no)n(w)h(and)g(then,)g
(someone)f(emails)i(the)f(tcpreplay-users)e(list,)j(asking)f(if)h
(there)f(is)h(a)g(b)n(ug)f(in)g(tcpreplay)f(which)h(causes)h(it)g(not)f
(to)g(send)g(all)h(the)g(pack)o(ets.)-364 4814 y(This)g(usually)f
(happens)f(when)h(the)h(user)f(uses)h(the)g(-R)g(\003ag)g(or)f(is)h
(replaying)e(a)i(high-speed)d(pcap)i(\002le)i(\(>)e(50Mbps,)f(although)
g(this)i(number)e(is)i(dependant)e(on)-364 4913 y(the)i(hardw)o(are)f
(in)i(use\).)-364 5063 y(The)f(short)g(v)o(ersion)f(of)h(the)g(answer)g
(is:)26 b(no,)20 b(we)g(are)g(not)g(a)o(w)o(are)g(of)g(an)o(y)f(b)n
(ugs)h(which)g(might)f(cause)h(a)h(fe)n(w)f(pack)o(ets)g(to)g(not)g(be)
g(sent.)-364 5212 y(The)g(longer)f(v)o(ersion)g(goes)h(something)f(lik)
o(e)h(this:)-364 5362 y(If)i(you)f(are)i(running)d(tcpreplay)g
(multiple)i(times)g(and)g(are)g(using)g(tcpdump)e(or)i(other)f(pack)o
(et)h(snif)n(fer)f(to)h(count)g(the)g(number)e(pack)o(ets)i(sent)g(and)
g(are)g(getting)-364 5461 y(dif)n(ferent)d(numbers,)f(it')-5
b(s)21 b(not)f(tcpreplay')-5 b(s)19 b(f)o(ault.)25 b(The)20
b(problem)f(lies)i(in)f(one)g(of)f(tw)o(o)i(places:)1908
5895 y(19)p eop end
%%Page: 20 20
TeXDict begin 20 19 bop -260 -281 a Fl(1.)41 b(It)25
b(is)i(well)f(kno)n(wn)e(that)h(tcpdump)f(and)h(other)f(snif)n(fers)h
(ha)n(v)o(e)g(a)h(problem)d(k)o(eeping)h(up)h(with)h(high-speed)d(traf)
n(\002c.)40 b(Furthermore,)25 b(the)g(OS)h(in)g(man)o(y)-156
-181 y(cases)e Fd(lies)h Fl(about)e(ho)n(w)g(man)o(y)f(pack)o(ets)i
(were)f(dropped.)34 b(Tcpdump)21 b(will)k(repeat)e(this)h(lie)g(to)g
(you.)35 b(In)23 b(other)g(w)o(ords,)h(tcpdump)e(isn')o(t)i(seeing)f
(all)h(the)-156 -82 y(pack)o(ets.)g(Usually)c(this)h(is)g(a)g(problem)d
(with)j(the)f(netw)o(ork)f(card)h(or)f(dri)n(v)o(er)g(which)h(may)g(or)
f(may)h(not)g(be)g(\002xable.)25 b(T)m(ry)19 b(another)g(netw)o(ork)g
(card/dri)n(v)o(er)-5 b(.)-260 73 y(2.)41 b(When)19 b(tcpreplay)g
(sends)h(a)g(pack)o(et,)f(it)i(actually)e(gets)h(copied)f(to)h(a)g
(send)f(b)n(uf)n(fer)g(in)h(the)g(k)o(ernel.)k(If)19
b(this)i(b)n(uf)n(fer)d(is)j(full,)f(the)f(k)o(ernel)h(is)g(supposed)f
(to)h(tell)-156 172 y(tcpreplay)f(that)h(it)h(didn')o(t)e(cop)o(y)h
(the)g(pack)o(et)g(to)h(this)g(b)n(uf)n(fer)-5 b(.)24
b(If)d(the)f(k)o(ernel)g(has)g(a)h(b)n(ug)f(which)g(squelches)g(this)h
(error)m(,)d(tcpreplay)h(will)i(not)g(k)o(eep)e(trying)-156
272 y(to)i(send)h(the)f(pack)o(et)g(and)g(will)i(mo)o(v)o(e)d(on)h(to)h
(the)f(ne)o(xt)g(one.)28 b(Currently)21 b(I)g(am)h(not)f(a)o(w)o(are)g
(of)h(an)o(y)f(OS)h(k)o(ernels)f(with)h(this)g(b)n(ug,)f(b)n(ut)g(it)i
(is)f(possible)f(that)-156 372 y(it)g(e)o(xists.)k(If)20
b(you)f(\002nd)h(out)g(that)g(your)f(OS)i(has)g(this)f(problem,)f
(please)h(let)h(me)f(kno)n(w)f(so)i(I)f(can)g(list)h(it)g(here.)-364
563 y(If)g(for)f(some)g(reason,)g(you)g(still)i(think)e(its)i(a)f(b)n
(ug)f(in)h(tcpreplay)-5 b(,)19 b(by)h(all)i(means)e(read)g(the)h(code)f
(and)g(tell)i(me)e(ho)n(w)h(stupid)f(I)h(am.)26 b(The)21
b(do_pack)o(ets\(\))d(function)-364 663 y(in)j(do_pack)o(ets.c)d(is)j
(where)e(tcpreplay)g(processes)h(the)g(pcap)g(\002le)g(and)g(sends)g
(all)h(of)f(the)g(pack)o(ets.)-364 976 y Fk(10)119 b(Requir)n(ed)32
b(Libraries)e(and)h(T)-11 b(ools)-364 1216 y Fj(10.1)99
b(Libpcap)-364 1410 y Fl(As)21 b(of)f(tcpreplay)f(v1.4,)g(you')o(ll)g
(need)h(to)h(ha)n(v)o(e)e(libpcap)h(installed)g(on)g(your)f(system.)25
b(As)c(of)f(v2.0,)f(you')o(ll)h(need)f(at)i(least)g(v)o(ersion)e(0.6.0)
g(or)h(better)m(,)f(b)n(ut)i(I)f(only)-364 1509 y(test)h(our)f(code)f
(with)i(the)f(latest)h(v)o(ersion.)i(Libpcap)c(can)h(be)g(obtained)f
(on)h(the)g(tcpdump)e(homepage)2573 1479 y Ff(11)2633
1509 y Fl(.)-364 1780 y Fj(10.2)99 b(Libnet)-364 1973
y Fl(Tcpreplay)23 b(v1.3)g(is)i(the)g(last)g(v)o(ersion)e(to)h(support)
f(the)i(old)f(libnet)g(API)g(\(e)n(v)o(erything)e(before)h(1.1.x\).)35
b(As)25 b(of)g(v1.4)e(you)g(will)i(need)f(to)g(use)h(Libnet)f(1.1.0)f
(or)-364 2073 y(better)d(which)g(can)g(be)g(obtained)e(from)i(the)g
(Libnet)f(homepage)1497 2043 y Ff(12)1557 2073 y Fl(.)-364
2344 y Fj(10.3)99 b(Libpcapna)n(v)-364 2537 y Fl(Starting)24
b(with)h(v2.0,)f(tcpreplay)f(can)h(use)h(libpcapna)n(v)d(to)j(support)e
(the)h(jump)g(of)n(fset)g(feature.)37 b(If)24 b(libpcapna)n(v)f(is)i
(not)f(found)f(on)h(the)g(system,)i(that)e(feature)-364
2637 y(will)d(be)f(disabled.)k(Libpcapna)n(v)19 b(can)h(be)g(found)e
(on)i(the)g(NetDude)g(homepage)1960 2607 y Ff(13)2019
2637 y Fl(.)-364 2907 y Fj(10.4)99 b(Tcpdump)-364 3101
y Fl(As)26 b(of)g(2.0,)g(tcpreplay)d(uses)j(tcpdump)e(\(the)h(binary)-5
b(,)25 b(not)g(code\))g(to)g(decode)f(pack)o(ets)i(to)f(STDOUT)h(in)f
(a)h(human)e(readable)g(\(with)i(practice\))e(format)g(as)j(it)-364
3201 y(sends)20 b(them.)25 b(If)20 b(you)f(w)o(ould)h(lik)o(e)g(this)h
(feature,)e(tcpdump)f(must)j(be)f(installed)g(on)g(your)e(system.)-362
3338 y(N)t Fb(O)q(T)t(E)t Fl(:)32 b(The)22 b(location)f(of)h(the)g
(tcpdump)f(binary)f(is)k(hardcoded)19 b(in)j(tcpreplay)f(at)i(compile)e
(time.)31 b(If)22 b(tcpdump)f(gets)h(renamed)f(or)h(mo)o(v)o(ed,)e(the)
i(feature)g(will)-364 3438 y(become)d(disabled.)-364
3775 y Fk(P)o(art)30 b(IV)-364 4021 y Fh(Other)44 b(Resour)m(ces)-364
4320 y Fk(11)119 b(Other)31 b(pcap)f(tools)f(a)m(v)o(ailable)-364
4560 y Fj(11.1)99 b(T)-9 b(ools)24 b(to)h(captur)n(e)i(netw)o(ork)f
(traf\002c)g(or)f(decode)h(pcap)g(\002les)-239 4743 y
Fg(\017)41 b Fl(tcpdump)-156 4843 y Fe(http://www.tcpdump.org/)-239
4997 y Fg(\017)g Fl(ethereal)-156 5097 y Fe(http://www.ethereal.com/)
-239 5251 y Fg(\017)g Fl(ettercap)-156 5351 y Fe
(http://ettercap.sourceforge.net/)p -364 5405 1851 4
v -298 5460 a Fc(11)-244 5484 y Fa(http://www.tcpdump.org/)-298
5541 y Fc(12)-244 5565 y Fa(http://www.packetfactory.net/Projects/Libn)
o(et/)-298 5622 y Fc(13)-244 5646 y Fa(http://netdude.sourceforge.net/)
1908 5895 y Fl(20)p eop end
%%Page: 21 21
TeXDict begin 21 20 bop -364 -281 a Fj(11.2)99 b(T)-9
b(ools)24 b(to)h(edit)h(pcap)f(\002les)-239 -92 y Fg(\017)41
b Fl(tcpslice)-156 8 y(Splits)21 b(pcap)e(\002les)i(into)f(smaller)g
(\002les)-156 107 y Fe(http://www.tcpdump.org/)-239 273
y Fg(\017)41 b Fl(mer)o(gecap)-156 373 y(Mer)o(ges)19
b(tw)o(o)h(pcap)g(capture)f(\002les)i(into)f(one)-156
473 y Fe(http://www.ethreal.com/)-239 639 y Fg(\017)41
b Fl(pcapmer)o(ge)-156 738 y(Mer)o(ges)19 b(tw)o(o)h(or)g(more)g(pcap)f
(capture)g(\002les)i(into)f(one)-156 838 y Fe
(http://tcpreplay.sourceforge.net/)-239 1004 y Fg(\017)41
b Fl(editcap)-156 1104 y(Con)m(v)o(erts)19 b(capture)g(\002le)i
(formats)e(\(pcap,)g(snoop,)g(etc\))-156 1203 y Fe
(http://www.ethreal.com/)-239 1369 y Fg(\017)41 b Fl(netdude)-156
1469 y(GTK)20 b(based)g(pcap)f(capture)h(\002le)g(editor)-5
b(.)25 b(Allo)n(ws)c(editing)e(most)h(an)o(ything)e(in)j(the)f(pack)o
(et.)-156 1569 y Fe(http://netdude.sourceforge.net/)-364
1856 y Fj(11.3)99 b(Other)26 b(useful)f(tools)-239 2045
y Fg(\017)41 b Fl(capinfo)-156 2145 y(Prints)20 b(statistics)i(and)e
(basic)g(information)e(about)h(a)i(pcap)e(\002le)-156
2244 y Fe(http://tcpreplay.sourceforge.net/)-239 2410
y Fg(\017)41 b Fl(te)o(xt2pcap)-156 2510 y(Generates)19
b(a)i(pcap)f(capture)f(\002le)i(from)e(a)h(he)o(x)g(dump)-156
2609 y Fe(http://www.ethreal.com/)-239 2775 y Fg(\017)41
b Fl(tcp\003o)n(w)-156 2875 y(Extracts)20 b(and)f(reassembles)h(the)g
(data)g(portion)f(on)h(a)g(per)n(-\003o)n(w)g(basis)h(on)e(li)n(v)o(e)h
(traf)n(\002c)g(or)g(pcap)g(capture)f(\002les)-156 2975
y Fe(http://www.circlemud.org/~jelson/s)o(oftwa)o(re/tcp)o(flow/)1908
5895 y Fl(21)p eop end
%%Page: 22 22
TeXDict begin 22 21 bop -364 -245 a Fh(A)l(ppendix)-364
66 y Fk(A)120 b(BSD)31 b(License)-364 302 y Fe(Copyright)48
b(\(c\))i(2001-2004)e(Aaron)h(Turner,)f(Matt)h(Bing.)99
b(All)49 b(rights)g(reserved.)-364 501 y(Some)g(portions)g(of)g(code)g
(are:)-364 600 y(Copyright\(c\))f(1999)h(Anzen)g(Computing.)f(All)h
(rights)g(reserved.)-364 800 y(Redistribution)e(and)j(use)f(in)g
(source)g(and)g(binary)g(forms,)g(with)g(or)g(without)-364
899 y(modification,)f(are)h(permitted)f(provided)g(that)h(the)h
(following)e(conditions)-364 999 y(are)h(met:)-364 1198
y(1.)h(Redistributions)d(of)i(source)g(code)g(must)g(retain)g(the)g
(above)g(copyright)-214 1298 y(notice,)f(this)h(list)g(of)h(conditions)
e(and)h(the)g(following)f(disclaimer.)-364 1397 y(2.)i(Redistributions)
d(in)i(binary)g(form)g(must)g(reproduce)f(the)h(above)g(copyright)-214
1497 y(notice,)f(this)h(list)g(of)h(conditions)e(and)h(the)g(following)
f(disclaimer)g(in)i(the)-214 1597 y(documentation)d(and/or)i(other)g
(materials)f(provided)g(with)h(the)g(distribution.)-364
1696 y(3.)h(Neither)e(the)h(names)g(of)h(the)f(copyright)f(owners)h
(nor)g(the)g(names)g(of)h(its)-214 1796 y(contributors)d(may)i(be)h
(used)f(to)g(endorse)g(or)g(promote)g(products)f(derived)h(from)-214
1896 y(this)g(software)f(without)h(specific)f(prior)h(written)f
(permission.)-364 1995 y(4.)i(All)f(advertising)f(materials)g
(mentioning)g(features)g(or)i(use)f(of)g(this)g(software)-214
2095 y(must)g(display)f(the)h(following)g(acknowledgement:)-15
2194 y(This)g(product)f(includes)h(software)f(developed)g(by)i(Anzen)f
(Computing,)f(Inc.)-364 2394 y(THIS)h(SOFTWARE)g(IS)g(PROVIDED)f(``AS)h
(IS'')g(AND)h(ANY)f(EXPRESS)g(OR)g(IMPLIED)-364 2493
y(WARRANTIES,)f(INCLUDING,)g(BUT)h(NOT)g(LIMITED)g(TO,)g(THE)g(IMPLIED)
g(WARRANTIES)f(OF)-364 2593 y(MERCHANTABILITY)f(AND)i(FITNESS)g(FOR)g
(A)h(PARTICULAR)e(PURPOSE)g(ARE)i(DISCLAIMED.)-364 2693
y(IN)g(NO)f(EVENT)g(SHALL)g(THE)g(AUTHORS)g(OR)g(COPYRIGHT)f(HOLDERS)h
(BE)g(LIABLE)g(FOR)g(ANY)-364 2792 y(DIRECT,)g(INDIRECT,)f(INCIDENTAL,)
g(SPECIAL,)g(EXEMPLARY,)g(OR)h(CONSEQUENTIAL)-364 2892
y(DAMAGES)g(\(INCLUDING,)e(BUT)j(NOT)f(LIMITED)f(TO,)i(PROCUREMENT)e
(OF)h(SUBSTITUTE)-364 2991 y(GOODS)g(OR)h(SERVICES;)e(LOSS)h(OF)g(USE,)
g(DATA,)g(OR)h(PROFITS;)e(OR)h(BUSINESS)-364 3091 y(INTERRUPTION\))f
(HOWEVER)g(CAUSED)h(AND)g(ON)g(ANY)h(THEORY)e(OF)i(LIABILITY,)e
(WHETHER)-364 3191 y(IN)i(CONTRACT,)e(STRICT)g(LIABILITY,)g(OR)i(TORT)f
(\(INCLUDING)f(NEGLIGENCE)g(OR)-364 3290 y(OTHERWISE\))g(ARISING)h(IN)g
(ANY)g(WAY)h(OUT)f(OF)g(THE)h(USE)f(OF)g(THIS)g(SOFTWARE,)f(EVEN)i(IF)
-364 3390 y(ADVISED)f(OF)g(THE)g(POSSIBILITY)f(OF)i(SUCH)f(DAMAGE.)1908
5895 y Fl(22)p eop end
%%Trailer

userdict /end-hook known{end-hook}if
%%EOF
